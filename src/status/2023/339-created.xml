<item>
   <title>Issue #339 created</title>
   <pubDate>2023-02-07T13:46:57Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/339</link>
   <guid>https://qt4cg.org/@qt4cg/2023/#created-339</guid>
   <description>&lt;div&gt;&lt;p&gt;The constraints on document-uri are too...constraining&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;The XPath data model imposes the following constraints on the document-uri property:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If the &lt;code&gt;document-uri&lt;/code&gt; is not the empty sequence, then the following constraint must hold: the node returned by evaluating &lt;code&gt;fn:doc()&lt;/code&gt; with the document-uri as its argument must return the document node that provided the value of the &lt;code&gt;document-uri&lt;/code&gt; property.&lt;/p&gt;
&lt;p&gt;In other words, for any Document Node &lt;code&gt;$arg&lt;/code&gt;, either &lt;code&gt;fn:document-uri($arg)&lt;/code&gt; must return the empty sequence or &lt;code&gt;fn:doc(fn:document-uri($arg))&lt;/code&gt; must return &lt;code&gt;$arg&lt;/code&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This contraint turns out to be inconvenient whenever the larger environment doesnâ€™t enforce a 1:1 mapping between URIs and documents.&lt;/p&gt;
&lt;p&gt;For example, in a browser context, a JavaScript function that returns different versions of the same document over time cannot identify those documents with the same document-uri.&lt;/p&gt;
&lt;p&gt;In XProc, a &lt;code&gt;p:add-attribute&lt;/code&gt; step that returns a copy of its input document with one additional attribute, cannot identify the output document with the same document-uri as the input document.&lt;/p&gt;
&lt;p&gt;Given that the document URI is often necessary to evaluate relative URI references within a document, the constraints imposed in the data model are too strict.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>
