<item>
   <title>Issue #316 created</title>
   <pubDate>2023-01-23T16:23:37Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/316</link>
   <guid>https://qt4cg.org/@qt4cg/2023/#created-316</guid>
   <description>&lt;div&gt;&lt;p&gt;Function fn:differences&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;I didn't see any issues thread devoted &lt;code&gt;fn:differences()&lt;/code&gt;, so am opening this one. Please respond with xrefs to anything relevant.&lt;/p&gt;
&lt;p&gt;Draft here:
https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-differences&lt;/p&gt;
&lt;p&gt;IMO, this function seems overly complicated for both users and implementors. The specs provide difficult reading. But it is the first function to try to address the desideratum for differencing. Something like it is needed methinks.&lt;/p&gt;
&lt;p&gt;My suggestion would be to simplify the function as a straightforward string comparison, i.e., change the signature to something like &lt;code&gt;fn:differences($input1 as xs:string, $input2 as xs:string) as OUTPUT&lt;/code&gt; where &lt;code&gt;OUTPUT&lt;/code&gt; is either a tree structure (like the output of &lt;code&gt;fn:analyze-string()&lt;/code&gt;) or a sequence of records (e.g., &lt;code&gt;(is-in-1 as xs:boolean, is-in-2 as xs:boolean, fragment as xs:string)&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;Such a change would make the function more tractable for both users and implementers. The user, would need to cast each sequence to a string, and in so doing will be able to (be compelled to) make fine-grained decisions on things such as normalization. Processor implementers have far simpler input, and they can choose the difference algorithm that makes best sense at the moment.&lt;/p&gt;
&lt;p&gt;One counterargument might be that the resultant output would be difficult to correlate to the original sequences. Ostensibly, one wants to do things such as decide whether to drop certain items in sequence 1 or sequence 2. My response is that the current draft results in output that suffers from the same problem. Navigating the map to correlate it to the original sequence sounds daunting. With my suggestion, there are ways around this, through auxiliary functions or arity expansions that normalize the output.&lt;/p&gt;
&lt;p&gt;But I don't want to get postprocessing output here, which would be tangential to the main question, i.e., how &lt;code&gt;fn:differences()&lt;/code&gt; should be constructed in a way conducive to both users and implementers.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>
