<item>
   <title>Issue #333 created</title>
   <pubDate>2023-02-01T00:34:41Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/333</link>
   <guid>https://qt4cg.org/@qt4cg/2023/#created-333</guid>
   <description>&lt;div&gt;&lt;p&gt;Equality of function items&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;The question of equality of function items arises in the discussion of determinism of functions and memo functions in XSLT - see F&amp;amp;O 3.1 section 1.7.4, and came up again today in the context of fn:deep-equal.&lt;/p&gt;
&lt;p&gt;1.7.4 makes a brave attempt to describe situations under which two functions are "identical", though leaving implementations room for flexibility. I think we can build on this and improve it, by describing more situations in which the result is predictable.&lt;/p&gt;
&lt;p&gt;The data model describes the properties of a function item, and we can say that two function items are equivalent if all their properties are the same.&lt;/p&gt;
&lt;p&gt;The properties that cause problems are the "implementation" and the "closure", and in both cases I think we can find ways of doing a comparison.&lt;/p&gt;
&lt;p&gt;For the implementation, we can define this by reference to the way in which the implementation property is set. For function items constructed by reference to static functions (e.g. &lt;code&gt;my:func#3&lt;/code&gt; or &lt;code&gt;function-lookup(my:func, 3)&lt;/code&gt;) then they have the same implementation if and only if they are constructed by reference to the same static function. Similarly for function items constructed by evaluating an inline function expression. Other ways of constructing a function item, such as partial application, essentially create a new function with the same implementation as an existing function and a different closure.&lt;/p&gt;
&lt;p&gt;For the closure (ignoring for the moment functions that include parts of the dynamic context in their closure), this is essentially just a set of variable bindings and it's not too difficult to say that functions are identical if these sets of variable bindings are identical.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>
