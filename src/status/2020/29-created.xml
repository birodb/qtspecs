<item>
   <title>Issue #29 created</title>
   <pubDate>2020-12-18T11:51:17Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/29</link>
   <guid>https://qt4cg.org/@qt4cg/2020/#created-29</guid>
   <description>&lt;div&gt;&lt;p&gt;[FO] array:members, map:entries, array:values, map:values&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;The suggested functions are based on the observations that:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;users who prefer readable function names tend to reject &lt;code&gt;?*&lt;/code&gt; as handy shortcut;&lt;/li&gt;
&lt;li&gt;functions are often more flexible and better composable than FLWOR enhancements (but of course both could be added).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Reece (@rhdunn) had the good suggestion to introduce the &lt;code&gt;map:entries&lt;/code&gt; function. Please note that I’ve deliberately omitted ideas here on how to simplify the key/value access to maps with single entries (e.g. by deconstruction). I think this should be discussed in a separate issue.&lt;/p&gt;
&lt;p&gt;For the past discussion, see the mailing list and Slack.&lt;/p&gt;
&lt;h2&gt;array:members&lt;/h2&gt;
&lt;h3&gt;Summary&lt;/h3&gt;
&lt;p&gt;Returns each member of an array as a new array. Equivalent to:&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-xquery"&gt;for $a in 1 to array:size($array)
return [ $array($a) ]
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;Signature&lt;/h3&gt;
&lt;pre&gt;&lt;code class="language-xquery"&gt;array:members($array as array(*)) as array(*)*
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;Example&lt;/h3&gt;
&lt;pre&gt;&lt;code class="language-xquery"&gt;(: Query :)
let $array := [ (), 2, (3, 4) ]
for $member in array:members($array)
return element numbers { $member }

(: Result :)
&amp;lt;numbers/&amp;gt;
&amp;lt;numbers&amp;gt;2&amp;lt;/numbers&amp;gt;
&amp;lt;numbers&amp;gt;3 4&amp;lt;/numbers&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;map:entries&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;EDIT:&lt;/strong&gt; Revised to match Reece’s suggestion.&lt;/p&gt;
&lt;h3&gt;Summary&lt;/h3&gt;
&lt;p&gt;Returns each entry (pair) of a map as a new map. Equivalent to:&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-xquery"&gt;map:for-each($map, function($key, $value) {
  map { "key": $key, "value": $value }
})
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;Signature&lt;/h3&gt;
&lt;pre&gt;&lt;code class="language-xquery"&gt;map:entries($map as map(*)) as map(*)*
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;Example&lt;/h3&gt;
&lt;pre&gt;&lt;code class="language-xquery"&gt;(: Query :)
let $map := map { 'a': (), 'b': 2, 'c': [ 3, 4 ] }
for $entry in map:entries($map)
return element { $entry?key } { string-join($entry?value) }

(: Result :)
&amp;lt;a/&amp;gt;
&amp;lt;b&amp;gt;2&amp;lt;/b&amp;gt;
&amp;lt;c&amp;gt;34&amp;lt;/c&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;array:values&lt;/h2&gt;
&lt;h3&gt;Summary&lt;/h3&gt;
&lt;p&gt;Returns all members of an array as a sequence. Equivalent to &lt;code&gt;$array?*&lt;/code&gt;, but better composable and easier to read (especially for newcomers), and known from other programming languages.&lt;/p&gt;
&lt;h3&gt;Signature&lt;/h3&gt;
&lt;pre&gt;&lt;code class="language-xquery"&gt;array:values($array as array(*)) as item()*
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;Example&lt;/h3&gt;
&lt;pre&gt;&lt;code class="language-xquery"&gt;(: Query :)
let $array := [ (), 2, [ 3, 4 ] ]
return array:values($array)

(: Result :)
2
[ 3, 4 ]
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;map:values&lt;/h2&gt;
&lt;h3&gt;Summary&lt;/h3&gt;
&lt;p&gt;Returns all values of a map as a sequence. Equivalent to &lt;code&gt;$map?*&lt;/code&gt;, but better composable and easier to read (especially for newcomers), and known from other programming languages.&lt;/p&gt;
&lt;h3&gt;Signature&lt;/h3&gt;
&lt;pre&gt;&lt;code class="language-xquery"&gt;map:values($map as map(*)) as item()*
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;Example&lt;/h3&gt;
&lt;pre&gt;&lt;code class="language-xquery"&gt;(: Query :)
let $map := map { 'a': (), 'b': 2, 'c': [ 3, 4 ] }
return map:values($map)

(: Result :)
2
[ 3, 4 ]
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>
