<item>
   <title>Issue #118 created</title>
   <pubDate>2022-06-21T16:38:15Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/118</link>
   <guid>https://qt4cg.org/@qt4cg/2022/#created-118</guid>
   <description>&lt;div&gt;&lt;p&gt;xsl:match - can we do better&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;The draft spec proposes an instruction xsl:match to test whether a given item matches a specified pattern, returning a boolean.&lt;/p&gt;
&lt;p&gt;While this fills a gap, it's rather clumsy, especially because instructions that return atomic values typically have to be wrapped in xsl:variable or xsl:function to be useful.&lt;/p&gt;
&lt;p&gt;It might be better to try and make xsl:apply-templates work more nicely as a function.&lt;/p&gt;
&lt;p&gt;The current &lt;code&gt;&amp;lt;xsl:match select="N" match="P"/&amp;gt;&lt;/code&gt; is roughly equivalent to &lt;code&gt;&amp;lt;xsl:apply-template mode="test-pattern" select="N"/&amp;gt;&lt;/code&gt; where&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;xsl:mode name="test-pattern" as="xs:boolean"&amp;gt;
   &amp;lt;xsl:template match="P"&amp;gt;&amp;lt;xsl:sequence select="true()"/&amp;gt;&amp;lt;/xsl:template&amp;gt;
   &amp;lt;xsl:template match="."&amp;gt;&amp;lt;xsl:sequence select="false()"/&amp;gt;&amp;lt;/xsl:template&amp;gt;
&amp;lt;/xsl:mode&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Can we improve this?&lt;/p&gt;
&lt;p&gt;(a) we could allow &lt;code&gt;&amp;lt;xsl:mode name="test-pattern" function-name="my:test"/&amp;gt; &lt;/code&gt; so that a function call &lt;code&gt;my:test(XXX)&lt;/code&gt; is equivalent to the instruction &lt;code&gt;&amp;lt;xsl:apply-templates mode="test-pattern" select="X"/&amp;gt;&lt;/code&gt;: that is, each mode can declare the name of a function whose effect is to apply templates in that mode (with no parameters).&lt;/p&gt;
&lt;p&gt;(b) we could allow a &lt;code&gt;select&lt;/code&gt; attribute on xsl:template to provide a quick way of returning the result, avoiding xsl:sequence.&lt;/p&gt;
&lt;p&gt;(c) we could allow &lt;code&gt;&amp;lt;xsl:mode on-no-match="return false()"/&amp;gt;&lt;/code&gt; to avoid the fallback template rule.&lt;/p&gt;
&lt;p&gt;The use-case would then become&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;xsl:mode name="test-pattern" as="xs:boolean" on-no-match="return false()" function-name="my:test"&amp;gt;
   &amp;lt;xsl:template match="P" select="true()"/&amp;gt;
&amp;lt;/xsl:mode&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>
