<item>
   <title>Issue #280 created</title>
   <pubDate>2022-12-01T15:14:06Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/280</link>
   <guid>https://qt4cg.org/@qt4cg/2022/#created-280</guid>
   <description>&lt;div&gt;&lt;p&gt;Why is resolve-uri forbidden from resolving against a URI that contains a fragment identifier?&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;The 3.1 F&amp;amp;O spec says, of &lt;code&gt;fn:resolve-uri()&lt;/code&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A dynamic error is raised [&lt;a href="https://www.w3.org/XML/Group/qtspecs/specifications/xpath-functions-31/html/Overview.html#ERRFORG0002"&gt;err:FORG0002&lt;/a&gt;] if $base is not a valid IRI according to the rules of RFC3987, extended with an implementation-defined subset of the extensions permitted in LEIRI, or if it is not a suitable IRI to use as input to the chosen resolution algorithm (for example, if it is a relative IRI reference, if it is a non-hierarchic URI, or &lt;strong&gt;if it contains a fragment identifier&lt;/strong&gt;).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;(emphasis added by me)&lt;/p&gt;
&lt;p&gt;What in the name of all things is that about? I've never noticed that before, and I haven't seen any other API (the URL API in Node and the browser for example) that cares.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;resolve-uri('test.xml', 'http://example.com/path/file.xml#foo')&lt;/code&gt; === &lt;code&gt;http://example.com/path/test.xml&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;I don't see why the presence of a fragment identifier should matter in the least.&lt;/p&gt;
&lt;p&gt;e.g.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt;&amp;gt; let url = new URL("http://example.com/path/file.xml#foo")
&amp;gt;&amp;gt; console.log(url.href)
http://example.com/path/file.xml#foo
&amp;gt;&amp;gt; let resolved = new URL("test.xml", url);
&amp;gt;&amp;gt; console.log(resolved.href)
http://example.com/path/test.xml
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>
