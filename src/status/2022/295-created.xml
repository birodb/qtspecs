<item>
   <title>Issue #295 created</title>
   <pubDate>2022-12-20T23:43:38Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/295</link>
   <guid>https://qt4cg.org/@qt4cg/2022/#created-295</guid>
   <description>&lt;div&gt;&lt;p&gt;Extend support for self-reference in record types&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;We currently allow a field in a record to have type "..", that is, the same type as the containing record definition.&lt;/p&gt;
&lt;p&gt;This isn't good enough for the fn:random-number-generator, where we need something like:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;random-number-generator-record:
record(
   number as xs:double,
   next as function() as #random-number-generator-record,
   permute as function(item()*) as item()*,
   *,
)

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;There are two ways we could tackle this. We could extend the syntax to allow ".." here, so it becomes
&lt;code&gt;next as function() as ..&lt;/code&gt; Or we could allow named item types to refer to themselves:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;xsl:item-type name="random-number-generator-record"
   as="record(
   number as xs:double,
   next as function() as type(random-number-generator-record),
   permute as function(item()*) as item()*,
   *,
)"&amp;gt;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We haven't really reviewed the proposal for named item types. It's easy enough to declare them in XQuery and XSLT (and not really very difficult to define the rules under which self-referential definitions are allowed). Free-standing XPath is a bit more of a problem.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>
