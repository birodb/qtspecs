<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>QT4 CG Meeting 032 Minutes 2023-04-25</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="/meeting/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="../../../css/style.css"/>
<link rel="shortcut icon" href="/img/QT4-64.png" />
<link rel="apple-touch-icon" sizes="64x64" href="/img/QT4-64.png" type="image/png" />
<link rel="apple-touch-icon" sizes="76x76" href="/img/QT4-76.png" type="image/png" />
<link rel="apple-touch-icon" sizes="120x120" href="/img/QT4-120.png" type="image/png" />
<link rel="apple-touch-icon" sizes="152x152" href="/img/QT4-152.png" type="image/png" />
</head>
<body>
<div id="content" class="content">
<h1 class="title">QT4 CG Meeting 032 Minutes 2023-04-25</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#minutes">Draft Minutes</a></li>
<li><a href="#new-actions">Summary of new and continuing actions <code>[0/12]</code></a></li>
<li><a href="#administrivia">1. Administrivia</a>
<ul>
<li><a href="#roll-call">1.1. Roll call <code>[10/13]</code></a></li>
<li><a href="#agenda">1.2. Accept the agenda</a>
<ul>
<li><a href="#h-C1590AE6-AA6D-49E9-A040-5006E92C0784">1.2.1. Status so far…</a></li>
</ul>
</li>
<li><a href="#approve-minutes">1.3. Approve minutes of the previous meeting</a></li>
<li><a href="#next-meeting">1.4. Next meeting</a></li>
<li><a href="#open-actions">1.5. Review of open action items <code>[2/8]</code></a></li>
</ul>
</li>
<li><a href="#technical-agenda">2. Technical Agenda</a>
<ul>
<li><a href="#pr-433">2.1. PR #433: Allow hex and binary literals and allow underscores</a></li>
<li><a href="#pr-434">2.2. PR #434: Functions to parse and format hex integers</a></li>
<li><a href="#iss-359">2.3. Issue #359: fn:void: Absorb result of evaluated argument</a></li>
</ul>
</li>
<li><a href="#adjourned">3. Adjourned</a></li>
</ul>
</div>
</div>

<div id="outline-container-minutes" class="outline-2">
<h2 id="minutes">Draft Minutes</h2>
<div class="outline-text-2" id="text-minutes">
</div>
</div>

<div id="outline-container-new-actions" class="outline-2">
<h2 id="new-actions">Summary of new and continuing actions <code>[0/12]</code></h2>
<div class="outline-text-2" id="text-new-actions">
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> QT4CG-002-10: BTW to coordinate some ideas about improving diversity in the group</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-016-08: RD to clarify how namespace comparisons are performed.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-026-01: MK to write a summary paper that outlines the decisions we need to make on “value sequences”
<ul class="org-ul">
<li>This is related to PR #368: Issue 129 - Context item generalized to context value and
subsequent discussion.</li>
</ul></li>
<li class="off"><code>[&#xa0;]</code> QT4CG-029-01: RD+DN to draft spec prose for the “divide and conquer” approach outlined in issue #399</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-029-07: NW to open the next discussion of #397 with a demo from DN
See PR <a href="https://qt4cg.org/dashboard/#pr-449">#449</a></li>
<li class="off"><code>[&#xa0;]</code> QT4CG-031-03: CG to draft a PR to address issue #410</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-032-01: NW to make sure open PRs are on the agendas in future</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-032-02: MK to adjust the grammar in #433 per CGs suggestion.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-032-03: MK to change 32 to 36 in 4.5.2 fn:parse-integer</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-032-04: JK to suggest an example for base 26.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-032-05: MK to check that the terminology in format number isn’t too biased towards decimal</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-032-06: MK to a compatibility note about the use of ^ in format number.</li>
</ul>
</div>
</div>

<div id="outline-container-administrivia" class="outline-2">
<h2 id="administrivia"><span class="section-number-2">1.</span> Administrivia</h2>
<div class="outline-text-2" id="text-administrivia">
</div>

<div id="outline-container-roll-call" class="outline-3">
<h3 id="roll-call"><span class="section-number-3">1.1.</span> Roll call <code>[10/13]</code></h3>
<div class="outline-text-3" id="text-roll-call">
<p>
Regrets BTW.
</p>

<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> Anthony (Tony) Bufort (AB)</li>
<li class="on"><code>[X]</code> Reece Dunn (RD)</li>
<li class="on"><code>[X]</code> Sasha Firsov (SF)</li>
<li class="on"><code>[X]</code> Christian Grün (CG)</li>
<li class="on"><code>[X]</code> Joel Kalvesmaki (JK) [0:06-]</li>
<li class="on"><code>[X]</code> Michael Kay (MK)</li>
<li class="on"><code>[X]</code> John Lumley (JL)</li>
<li class="on"><code>[X]</code> Dimitre Novatchev (DN)</li>
<li class="on"><code>[X]</code> Ed Porter (EP)</li>
<li class="on"><code>[X]</code> C. M. Sperberg-McQueen (MSM)</li>
<li class="off"><code>[&#xa0;]</code> Bethan Tovey-Walsh (BTW)</li>
<li class="on"><code>[X]</code> Norm Tovey-Walsh (NW). <i>Scribe</i>. <i>Chair</i>.</li>
</ul>
</div>
</div>

<div id="outline-container-agenda" class="outline-3">
<h3 id="agenda"><span class="section-number-3">1.2.</span> Accept the agenda</h3>
<div class="outline-text-3" id="text-agenda">
<p>
Proposal: Accept <a href="../../agenda/2023/04-25.html">the agenda</a>.
</p>

<p>
Accepted.
</p>
</div>

<div id="outline-container-h-C1590AE6-AA6D-49E9-A040-5006E92C0784" class="outline-4">
<h4 id="h-C1590AE6-AA6D-49E9-A040-5006E92C0784"><span class="section-number-4">1.2.1.</span> Status so far…</h4>
<div class="outline-text-4" id="text-h-C1590AE6-AA6D-49E9-A040-5006E92C0784">

<div id="orgf98e15d" class="figure">
<p><img src="./issues-open-2023-04-25.png" alt="issues-open-2023-04-25.png" />
</p>
<p><span class="figure-number">Figure 1: </span>“Burn down” chart on open issues</p>
</div>


<div id="org8def6a2" class="figure">
<p><img src="./issues-by-spec-2023-04-25.png" alt="issues-by-spec-2023-04-25.png" />
</p>
<p><span class="figure-number">Figure 2: </span>Open issues by specification</p>
</div>


<div id="org7959944" class="figure">
<p><img src="./issues-by-type-2023-04-25.png" alt="issues-by-type-2023-04-25.png" />
</p>
<p><span class="figure-number">Figure 3: </span>“Burn down” chart on open issues</p>
</div>
</div>
</div>
</div>

<div id="outline-container-approve-minutes" class="outline-3">
<h3 id="approve-minutes"><span class="section-number-3">1.3.</span> Approve minutes of the previous meeting</h3>
<div class="outline-text-3" id="text-approve-minutes">
<p>
Proposal: Accept <a href="../../minutes/2023/04-18.html">the minutes of the previous meeting</a>.
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-next-meeting" class="outline-3">
<h3 id="next-meeting"><span class="section-number-3">1.4.</span> Next meeting</h3>
<div class="outline-text-3" id="text-next-meeting">
<p>
The next meeting <a href="../../agenda/2023/05-02.html">is scheduled for Tuesday, 2 May 2023</a>.
</p>

<p>
No regrets heard.
</p>

<p>
ACTION QT4CG-032-01: NW to make sure open PRs are on the agendas in future
</p>
</div>
</div>

<div id="outline-container-open-actions" class="outline-3">
<h3 id="open-actions"><span class="section-number-3">1.5.</span> Review of open action items <code>[2/8]</code></h3>
<div class="outline-text-3" id="text-open-actions">
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> QT4CG-002-10: BTW to coordinate some ideas about improving diversity in the group</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-016-08: RD to clarify how namespace comparisons are performed.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-026-01: MK to write a summary paper that outlines the decisions we need to make on “value sequences”
<ul class="org-ul">
<li>This is related to PR #368: Issue 129 - Context item generalized to context value and
subsequent discussion.</li>
</ul></li>
<li class="off"><code>[&#xa0;]</code> QT4CG-029-01: RD+DN to draft spec prose for the “divide and conquer” approach outlined in issue #399</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-029-07: NW to open the next discussion of #397 with a demo from DN</li>
<li class="on"><code>[X]</code> QT4CG-031-01: MK to update <code>map:of</code> to have more complete examples
See PR <a href="https://qt4cg.org/dashboard/#pr-449">#449</a></li>
<li class="on"><code>[X]</code> QT4CG-031-02: MK to make the map options into definitions.
See PR <a href="https://qt4cg.org/dashboard/#pr-449">#449</a></li>
<li class="off"><code>[&#xa0;]</code> QT4CG-031-03: CG to draft a PR to address issue #410</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-technical-agenda" class="outline-2">
<h2 id="technical-agenda"><span class="section-number-2">2.</span> Technical Agenda</h2>
<div class="outline-text-2" id="text-technical-agenda">
<p>
Once again, this week’s agenda mostly continues where we left off last week.
I’ve moved a couple of hopefully easy PRs to the top of the list.
</p>
</div>

<div id="outline-container-pr-433" class="outline-3">
<h3 id="pr-433"><span class="section-number-3">2.1.</span> PR #433: Allow hex and binary literals and allow underscores</h3>
<div class="outline-text-3" id="text-pr-433">
<p>
See PR <a href="https://qt4cg.org/dashboard/#pr-433">#433</a>
</p>

<p>
MK walks us through the issue.
</p>

<ul class="org-ul">
<li>MK: The change is quite modest, but there are a few small questions.
<ul class="org-ul">
<li>… The change is essentially in literals; we introduce two new
forms of numeric literals.</li>
<li>… Change for digits production is to allow underscores.</li>
<li>… What rules should we apply? Underscores at the beginning or end
or adjacent?</li>
</ul></li>
<li>CG: I gave some examples for Java and JavaScript
<ul class="org-ul">
<li>… (Looking at a comment on the PR)</li>
</ul></li>
<li>NW: I think we should avoid them at the beginning.</li>
<li>MK: I like CG’s version of the grammar.</li>
<li>MSM: The only case I can imagine for wanting an underscore at the
end is if I’m aligning several lines of numeric constants.</li>
<li>DN: What’s the purpose of using underscore?</li>
<li>MK: When you have long numbers, like one trillion, it helps you
count the number of digits.</li>
<li>MSM: Because you can’t use “,” or “.” without confusing half of the world.</li>
<li>RD: Different languages can use different symbols; C++ uses <code>'</code>.</li>
</ul>

<p>
ACTION QT4CG-032-02: MK to adjust the grammar in #433 per CGs suggestion.
</p>

<p>
Proposal: Accept this PR
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-pr-434" class="outline-3">
<h3 id="pr-434"><span class="section-number-3">2.2.</span> PR #434: Functions to parse and format hex integers</h3>
<div class="outline-text-3" id="text-pr-434">
<p>
See PR <a href="https://qt4cg.org/dashboard/#pr-434">#434</a>
</p>

<p>
MK reviews the PR.
</p>

<ul class="org-ul">
<li>MK: This primarily changes the F&amp;O spec.
<ul class="org-ul">
<li>… The first change is for parsing integers in different radixes.</li>
<li>… We have <code>fn:parse-integer</code> with a radix that defaults to 10.</li>
<li>… It doesn’t express formally what the result is; we just assume it’s obvious.</li>
</ul></li>
<li>RD: We’re not using this to potentially be able to parse things like
roman numerals and things.</li>
<li>MK: No, and it’s ASCII digits only.</li>
<li>RD: Counter styles has a good discussion of this:
<a href="https://www.w3.org/TR/css-counter-styles-3/">https://www.w3.org/TR/css-counter-styles-3/</a></li>
<li>MSM: Is dotted uppercase I the equivalent of uppercase I?</li>
</ul>

<p>
Some discussion of how much precision we need to apply. If it’s not
obvious, then we probably ought to spell it out in horrid detail.
</p>

<ul class="org-ul">
<li>DN: I was expecting to see examples with underscores in them. If
users will type them, it will be convenient to allow them here. I’m
guessing that there’s no limit on the size of the integer or the
length of the strings.</li>
<li>MK: On the first point, I thought the use cases is for reading
documents in a variety of formats. If the format does allow
underscores, it’s easier to strip them out.
<ul class="org-ul">
<li>… I deliberately chose not to on the grounds that a typical input
document that you’re reading (a color attribute in a CSS document)
is going to require some preprocessing and it’s easy enough to
strip them out.</li>
<li>… On the second point, there’s an error condition if it’s too big.</li>
</ul></li>
</ul>

<p>
Some discussion of how many digits are required/allowed.
</p>

<p>
ACTION QT4CG-032-03: MK to change 32 to 36 in 4.5.2 fn:parse-integer
</p>

<ul class="org-ul">
<li>DN: Maybe it could be an alternative to have a second argument to
allow underscores. Otherwise it’s a little bit confusing.</li>
<li>MK: I do think the use cases are very different.</li>
<li>NW: I don’t see how throwing away underscores would be more difficult.</li>
<li>MK: I guess we could.</li>
<li>JK: I think we should support underscores here. One thing I’m going
to be doing is parsing XSLT. The one thing I think is missing is
base64binary, but obviously you can just cast that and manipulate
it. It would also be helpful to have examples that demonstrate the
base 26 case which usually only uses letters.</li>
<li>MK: Where is it used?</li>
<li>JK: In our workshop, we use aaa for 0, etc. And we have files with
these extensions.</li>
<li>RD: Excel indexes are also done this way.</li>
</ul>

<p>
ACTION QT4CG-032-04: JK to suggest an example for base 26.
</p>

<ul class="org-ul">
<li>JL: I tend to agree with MK that keeping this just acting on the
digits is the best thing. There are all sorts separators could be
used. I suggest we add a note that specifically says that we
anticipate that other separators will be stripped out.</li>
<li>NW: That also sounds reasonable to me.</li>
<li>SF: We could have an optional parameter that specifies ignored characters.
You could ignore hash for example or apostrophes, etc.
<ul class="org-ul">
<li>… It would also be nice to be able to specify the characters in
the alphabet. That would make for a wider use case.</li>
</ul></li>
<li>MK: My feeling is that the design principle is that functions should
do one thing and do it well. You can handle both of those use cases
by combining this function with translate. Rather than having one
function do too much.</li>
<li>RD: I was going to say what SF said.</li>
<li>SF: An example that uses translate would be good.</li>
<li>MK: Yes.</li>
</ul>

<p>
MK moves on to formatting numbers.
</p>

<ul class="org-ul">
<li>MK: I’ve extended the <code>fn:format-integer</code> to accept the radix in the
format string.
<ul class="org-ul">
<li>… The picture string begins with (base)^, so “2^” for binary,
“16^” for hex.</li>
<li>… That’s <b>almost</b> backwards compatible except in some very rare cases.</li>
<li>… It requires a fair bit of generalization in the text that may
not be perfect yes.</li>
</ul></li>
<li>RD: What are the compatibility issues?</li>
<li>MK: If you used the “^” as the grouping separator, you’re allowed to
repeat the digits. So “16^16” would mean output the number with the
grouping charater “^” every two characters.</li>
</ul>

<p>
Some discussion about whether there’s a note about the incompatibility or not.
</p>

<p>
ACTION QT4CG-032-05: MK to check that the terminology in format number isn’t too biased towards decimal
</p>

<p>
ACTION QT4CG-032-06: MK to a compatibility note about the use of ^ in format number.
</p>

<p>
Proposal: Accept this PR:
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-iss-359" class="outline-3">
<h3 id="iss-359"><span class="section-number-3">2.3.</span> Issue #359: fn:void: Absorb result of evaluated argument</h3>
<div class="outline-text-3" id="text-iss-359">
<p>
See Issue <a href="https://github.com/qt4cg/qtspecs/issues/359">#359</a>
</p>

<ul class="org-ul">
<li>CG: If you have functions that have side effects or if you aren’t
interested in the results, then you have a case where you aren’t
interested in the result, but only if the code is executed.
<ul class="org-ul">
<li>… People often try to circumvent the problem that functions always
return something.</li>
<li>(There are examples in the issue.)</li>
<li>… One solution is to have a <code>fn:void()</code> function that evaluates
code and always returns an empty sequence.</li>
<li>… It’s not really settled what happens with non-deterministic code or side-effects.</li>
<li>… My suggestion is that we enforce the evaluation of the argument
whenever it’s non-deterministic, but an implementation might
otherwise be free not to evaluate it.</li>
<li>… But I’m not sure.</li>
</ul></li>
<li>DN: I think that it’s a good proposal. I have a number of comments,
but my main concern is that this function <code>fn:void</code> seems a little
confusing. What’s wanted here is eager evaluation of the argument.
So we could call it <code>fn:eager</code>. This is a very special function, the
optimizer must not discard it! Using the determinism of the argument
may be difficult.</li>
<li>CG: I think your use cases are interesting, but I definitely think
it’s a different use case. Here it’s really about ignoring the
result. I think we should talk about eager and lazy functions in a
different context.</li>
<li>DN: Okay, but we need to be clear about evaluation of the arguments.</li>
<li>RD: Eager evaluation vs lazy evaluation is different than what this
is proposing. I pointed this out in the examples on the issue. For a
database query, for example, you always want the result whether it
was eager or lazy, but this is explicitly about discarding the result.
<ul class="org-ul">
<li>… Consider <code>1 =&gt; fn:void(), 2 =&gt; fn:eager()</code>; it should return <code>2</code> <b>not</b> <code>(1,2)</code>.</li>
<li>… In a nested loop, lazy evaluation could evaluate each item multiple times.</li>
</ul></li>
<li>JL: I think DN is right that this function has to be treated
specially by the compilers. It’s signature says it produces a
constant result, so the optimizer could easily just replace all the calls.</li>
<li>MSM: I’m having trouble getting my head around the proposal and the discussion.
<ul class="org-ul">
<li>… First, I think it’s true that lazy vs eager is not the same as I
care about the result or discard it. The use case that makes sense
to me is that I have some code that I want to evaluate for the
side effects.</li>
<li>… The second thing that bothers me is when you’re writing a script
that calls programs, you must always check the return code.
Because if you don’t care about the result, why are you calling
the program in the first place.</li>
</ul></li>
<li>CG: In our cases, we have users that use modules that are written by
other people. Some raise errors, some return errors. Sometimes all
you care about is whether the code parses or not. Or sometimes you
might get a jobid and maybe you don’t care about it.</li>
<li>MSM: Ok. Earlier, you talked about wrapping a function call in void
in order to comment it out. But when I do that, I expect them not to
be executed. But that’s not quite the same here.</li>
<li>CG: Right. That’s something we should clarify that. I think it
depends a lot on the implementations. For BaseX, we only evaluate
non-deterministic code. But we could say always for fn:void.</li>
<li>DN: I wanted to say what MSM said. It seems bad to ignore the return code.
<ul class="org-ul">
<li>… This is a special case of a special case. I think that we have a
general case that is more important: that’s eager vs. lazy evaluation.</li>
</ul></li>
<li>RD: I wonder if we’ve got a slight difference in terminolgy here. If
I understand DN and MSM correctly, “eager” means that at the point
when the function is called the expression gets evaluated to some
value. Whereas if you don’t use that, the processor is able to defer
the evaluation to some point in the future. What I’m referring to is
the value is computed but is returning a generator function that
generates the values on demand. That being “lazy” evaluation and
“eager” computes them all.</li>
<li>DN: When we have “eager” we don’t care internally how it works.</li>
<li>CG: Do you always get the result without eager?</li>
</ul>

<p>
Some discussion of what happens to return values.
</p>

<ul class="org-ul">
<li>MK: This is all about forcing evaluation of things that have side
effects. We have a long history of trying to do that with
xsl:result-document. It proved fairly troublesome over the years
because we don’t really have order-of-execution semantics to
underpin it. It’s been made workable mainly by constraining the
places where you can use it.
<ul class="org-ul">
<li>… Assigning an expression to variable that isn’t used isn’t going
to be solved by calling fn:void on the right hand side.</li>
<li>… In XSLT, we only allow it at the top level so it’s implicitly a
sequential evaluation.</li>
<li>… I don’t think we can use <code>fn:void()</code> anywhere in an expression
without having a lot more work on the semantics.</li>
</ul></li>
<li>CG: I assume that functions like <code>file:write</code> are implemented
differently in Saxon and BaseX. The challenge is the same but the
solutions are different.</li>
<li>MK: If the user puts them where the optimizer can muck with them,
then they may not get the results the expect. If you put
<code>file:write</code> inside a predicate or sort key, it’s going to be pretty
unpredictable what happens.</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-adjourned" class="outline-2">
<h2 id="adjourned"><span class="section-number-2">3.</span> Adjourned</h2>
<div class="outline-text-2" id="text-adjourned">
<p>
None heard.
</p>
</div>
</div>
</div>
</body>
</html>