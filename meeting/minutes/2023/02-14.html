<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>QT4 CG Meeting 022 Minutes 2023-02-14</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="/meeting/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="../../../css/style.css"/>
<link rel="shortcut icon" href="/img/QT4-64.png" />
<link rel="apple-touch-icon" sizes="64x64" href="/img/QT4-64.png" type="image/png" />
<link rel="apple-touch-icon" sizes="76x76" href="/img/QT4-76.png" type="image/png" />
<link rel="apple-touch-icon" sizes="120x120" href="/img/QT4-120.png" type="image/png" />
<link rel="apple-touch-icon" sizes="152x152" href="/img/QT4-152.png" type="image/png" />
</head>
<body>
<div id="content" class="content">
<h1 class="title">QT4 CG Meeting 022 Minutes 2023-02-14</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#minutes">Minutes</a></li>
<li><a href="#new-actions">Summary of new and continuing actions <code>[0/11]</code></a></li>
<li><a href="#administrivia">1. Administrivia</a>
<ul>
<li><a href="#roll-call">1.1. Roll call <code>[10/14]</code></a></li>
<li><a href="#agenda">1.2. Accept the agenda</a></li>
<li><a href="#approve-minutes">1.3. Approve minutes of the previous meeting</a></li>
<li><a href="#next-meeting">1.4. Next meeting</a></li>
<li><a href="#open-actions">1.5. Review of open action items <code>[0/6]</code></a></li>
</ul>
</li>
<li><a href="#technical-agenda">2. Technical Agenda</a>
<ul>
<li><a href="#pr-342">2.1. PR #342: Meta elements</a></li>
<li><a href="#pr-344">2.2. PR #344: Issue 22, allow for/let to be repeated</a></li>
<li><a href="#h-8455483D-D0AF-499A-A74A-552B33A9F395">2.3. PR #320: Issue 98 - add options parameter to fn:deep-equal</a></li>
</ul>
</li>
<li><a href="#any-other-business">3. Any other business</a></li>
</ul>
</div>
</div>

<div id="outline-container-minutes" class="outline-2">
<h2 id="minutes">Minutes</h2>
<div class="outline-text-2" id="text-minutes">
<p>
Approved <a href="./02-21.html">at meeting 023</a> on 14 February 2023.
</p>
</div>
</div>

<div id="outline-container-new-actions" class="outline-2">
<h2 id="new-actions">Summary of new and continuing actions <code>[0/11]</code></h2>
<div class="outline-text-2" id="text-new-actions">
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> QT4CG-002-10: BTW to coordinate some ideas about improving diversity in the group</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-016-08: RD to clarify how namespace comparisons are performed.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-021-01: NW to raise a PR addressing the points in issue #307</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-021-02: NW to check for deprecated URI features and add options for them in <code>fn:build-uri</code> and <code>fn:parse-uri</code></li>
<li class="off"><code>[&#xa0;]</code> QT4CG-021-03: RD to change <code>must</code> to <code>will</code> in DOM notes about lowercase</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-021-04: RD to revise and move the note about unrecognized entities</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-022-01: NW to investigate the illegible, dark blue background color in serialization</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-022-02: MK to add meta element selection to the list of implementation-defined things in serialization</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-022-03: MK to add a note about why multiple for and let clauses were added to XPath</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-022-04: MK to update the collation parameter on fn:deep-equal to accept an empty sequence.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-022-05: MK to make sure that the option list in fn:deep-equal is sorted lexicographically</li>
</ul>
</div>
</div>

<div id="outline-container-administrivia" class="outline-2">
<h2 id="administrivia"><span class="section-number-2">1.</span> Administrivia</h2>
<div class="outline-text-2" id="text-administrivia">
</div>

<div id="outline-container-roll-call" class="outline-3">
<h3 id="roll-call"><span class="section-number-3">1.1.</span> Roll call <code>[10/14]</code></h3>
<div class="outline-text-3" id="text-roll-call">
<p>
Regrets: BTW
</p>

<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> Anthony (Tony) Bufort (AB)</li>
<li class="on"><code>[X]</code> Reece Dunn (RD)</li>
<li class="on"><code>[X]</code> Sasha Firsov (SF)</li>
<li class="on"><code>[X]</code> Christian Grün (CG)</li>
<li class="on"><code>[X]</code> Joel Kalvesmaki (JK) [:08-]</li>
<li class="on"><code>[X]</code> Michael Kay (MK)</li>
<li class="on"><code>[X]</code> John Lumley (JL)</li>
<li class="on"><code>[X]</code> Dimitre Novatchev (DN)</li>
<li class="on"><code>[X]</code> Ed Porter (EP)</li>
<li class="off"><code>[&#xa0;]</code> Liam Quin (LQ)</li>
<li class="off"><code>[&#xa0;]</code> Adam Retter</li>
<li class="on"><code>[X]</code> C. M. Sperberg-McQueen (MSM) [:06-]</li>
<li class="off"><code>[&#xa0;]</code> Bethan Tovey-Walsh (BTW)</li>
<li class="on"><code>[X]</code> Norm Tovey-Walsh (NW). <i>Scribe</i>. <i>Chair</i>.</li>
</ul>
</div>
</div>

<div id="outline-container-agenda" class="outline-3">
<h3 id="agenda"><span class="section-number-3">1.2.</span> Accept the agenda</h3>
<div class="outline-text-3" id="text-agenda">
<p>
Proposal: Accept <a href="../../agenda/2023/02-14.html">the agenda</a>.
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-approve-minutes" class="outline-3">
<h3 id="approve-minutes"><span class="section-number-3">1.3.</span> Approve minutes of the previous meeting</h3>
<div class="outline-text-3" id="text-approve-minutes">
<p>
Proposal: Accept <a href="../../minutes/2023/02-07.html">the minutes of the previous meeting</a>.
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-next-meeting" class="outline-3">
<h3 id="next-meeting"><span class="section-number-3">1.4.</span> Next meeting</h3>
<div class="outline-text-3" id="text-next-meeting">
<p>
The next meeting <a href="../../agenda/2023/02-21.html">is scheduled for Tuesday, 21 February 2023</a>.
</p>

<p>
Focus next week is XSLT; MK to help with the agenda.
</p>

<p>
Regrets: CG.
</p>
</div>
</div>

<div id="outline-container-open-actions" class="outline-3">
<h3 id="open-actions"><span class="section-number-3">1.5.</span> Review of open action items <code>[0/6]</code></h3>
<div class="outline-text-3" id="text-open-actions">
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> QT4CG-002-10: BTW to coordinate some ideas about improving diversity in the group</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-016-08: RD to clarify how namespace comparisons are performed.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-021-01: NW to raise a PR addressing the points in issue #307</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-021-02: NW to check for deprecated URI features and add options for them in <code>fn:build-uri</code> and <code>fn:parse-uri</code></li>
<li class="off"><code>[&#xa0;]</code> QT4CG-021-03: RD to change <code>must</code> to <code>will</code> in DOM notes about lowercase</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-021-04: RD to revise and move the note about unrecognized entities</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-technical-agenda" class="outline-2">
<h2 id="technical-agenda"><span class="section-number-2">2.</span> Technical Agenda</h2>
<div class="outline-text-2" id="text-technical-agenda">
</div>

<div id="outline-container-pr-342" class="outline-3">
<h3 id="pr-342"><span class="section-number-3">2.1.</span> PR #342: Meta elements</h3>
<div class="outline-text-3" id="text-pr-342">
<p>
See <a href="https://qt4cg.org/dashboard/#pr-342">pull request #342</a>.
</p>

<ul class="org-ul">
<li>MK: This is a bug from a Saxon user. The XHTML and HTML methods add
meta elements with a content type. HTML5 has introduced a new meta
element that doesn’t have a content type, it just says charset=. If
we leave that one in the document, then you get an HTML validation
error.
<ul class="org-ul">
<li>… Compliance with the serialization spec leads to invalid HTML.</li>
<li>… We fixed that in Saxon but now we’re not compliant with the
serialization spec!</li>
<li>… This PR proposes to update the serialization spec.</li>
</ul></li>
</ul>

<p>
The changes are all in the serialization spec.
</p>

<ul class="org-ul">
<li>MK: I did some housekeeping; I dropped all the diff markup from
before 3.1. Fixed a few whitespace issues.</li>
<li>MK summarizes changes to section 4.
<ul class="org-ul">
<li>Some discussion of the change from “along with discarding” to
“possibly replacing”</li>
</ul></li>
</ul>

<p>
ACTION QT4CG-022-01: NW to investigate the illegible, dark blue background color in serialization
</p>

<ul class="org-ul">
<li>MK discusses the changes in the beginning of 6.1.14.</li>
<li>MK: Basically, this just licenses the new syntax if that’s what you
choose to do.</li>
<li>MK: It says pretty much the same thing for the HTML output method in
7.4.13.</li>

<li>DN: Seems ok, but I’m a little bit concerned about using “might” and
“may”. That means it depends on the implementation.</li>
<li>MK: Yes, that’s a good point. I decided not to require that
implementations use the new behavior. Some implementations might
want to keep the old syntax.</li>
</ul>

<p>
Some discussion about the fact that it’s an implementation-defined result.
</p>

<ul class="org-ul">
<li>NW: Perhaps making this a “should” requirement would help?</li>
</ul>

<p>
Some discussion of the fact that this only applies to the HTML5 output
method.
</p>

<ul class="org-ul">
<li>MK: Should we even continue supporting versions of HTML before 5 anyway?</li>
<li>MSM: For what it’s worth, as a late adopter, I would be very unhappy
if we got rid of HTML4 because that’s typically what I use.
<ul class="org-ul">
<li>… I do kind of like the idea that if we’re going to offer this as
a choice we should add it to the list of things that are
implementation-defined.</li>
</ul></li>
</ul>

<p>
ACTION QT4CG-022-02: MK to add meta element selection to the list of implementation-defined things in serialization
</p>

<ul class="org-ul">
<li>SF: Depending on the situation, I’d be rendering in XHTML or HTML5.
That means I’d have to change how the meta tag differently in
different cases.</li>
<li>MK: They’re different output methods, but they share a lot in
common. The way the spec is structured, they have to be described
twice, but both methods take the same option.
<ul class="org-ul">
<li>… I don’t really understand how XHTML evolves as HTML5 changes.</li>
</ul></li>
<li>RD: Effectively, XHTML is an XML serialization of the
HTML5 DOM.</li>
<li>NW: That’s what I thought.</li>

<li>DN: I’m happy we discussed this. We must be aware that I find this
is a problem as a developer. I think if there are implementation
defined things, maybe we should provide an appendix that shows the
choices implementations made.</li>
</ul>

<p>
Some discussion of the appropriateness of adding this to the
specification. The Schema WG did not find the process of trying to
maintain this kind of thing easy or satisfactory.
</p>

<p>
DN remains concerned that there should be some place where the
implementation defined features for all the implementations can be
recorded.
</p>

<ul class="org-ul">
<li>MK: Are you volunteering?</li>
<li>DN: I don’t have much experience, but maybe.</li>
</ul>

<p>
Proposal: Accept this PR
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-pr-344" class="outline-3">
<h3 id="pr-344"><span class="section-number-3">2.2.</span> PR #344: Issue 22, allow for/let to be repeated</h3>
<div class="outline-text-3" id="text-pr-344">
<p>
See <a href="https://qt4cg.org/dashboard/#pr-344">pull request #344</a>.
</p>

<ul class="org-ul">
<li>MK: I think this was originally raised by RD. The only question here
is how far to go. I chose not to go very far. I changed things so
that let and for can be repeated but not mixed.</li>
</ul>

<p>
MK shares the XPath spec for review.
</p>

<ul class="org-ul">
<li>MK: SimpleForClause allows the keyword “for” as an alternative to
“,” which makes it look more like an XQuery FLOWR expression with
multiple “for”s
<ul class="org-ul">
<li>… The spec describes how the “for”s are syntactic sugar.</li>
</ul></li>
<li>MK: We do the same thing for let expressions in SimpleLetClause.
<ul class="org-ul">
<li>… This doesn’t preclude going further, but it’s a starting point.</li>
</ul></li>
<li>DN: Who needs this? We have the “,” why do we need repeated “for” or
“let”?</li>
<li>RD: It’s a preference thing; if you’re copying code from XQuery
where you’ve used multiple fors or lets, or if you have an XQuery
background, it will be what’s familiar.
<ul class="org-ul">
<li>… Kind of like how many languages support multiple variable
declarations by commas or repeated specifications.
<code>(int x; int y; int j; vs. int x,y,j;)</code></li>
</ul></li>
<li>DN: Then maybe the prose should explain that.</li>
<li>MSM: I’m kind of torn; MK has probably hit something of a sweet spot
here, precisely because for/let and the “,” are synonymous. Because
XPath is not quite the same as XQuery makes me have to think harder.
And the fact that XPath is more restrictive, that helps me keep
track of the boundary. Anything that makes it look more like XQuery
makes me worry that I’ll have a harder time maintaining the
distinction.
<ul class="org-ul">
<li>… As to the concern, why would anyone want to do this, I use
repeated “for” instead of “,” as a rhetorical device. It lets me
make it clear to six-months-from-now-me, that these are the
variables I’m going to be changing and not these other variables.
Using “for” to signal a fresh start is useful to me.</li>
</ul></li>
<li>JL: Something that’s bugging me: the “,” embedded after the let
stands for “return let”. When “let” is embedded, it also means
“return let”. But you could write “return let”, so you’ve got a
weirdly redundant token!</li>
<li>MK: It’s just saying you can leave out the return.</li>
<li>RD: This is saying that these are defined in terms of single lets
and single fors because XPath originally only had one. So you had to
define the comma version as an expansion. Or was it something like
that?</li>
<li>MK: It allowed the “,” from the beginning. The reason that it was a
macro was to avoid adding tuple streams of bindings to the
semantics.</li>
<li>DN: I hear what MSM is saying, that he doesn’t want XQuery to be
mechanically put into XPath. I wouldn’t object to having in XPath an
XQuery feature that gives us new functionality, but this doesn’t
provide any new functionality.</li>
<li>MK: From my perspective, I find laying things out with “,”s much
more difficult. I’ve tended to standardize on putting the comma at
the beginning of the line which is ugly. Putting it at the end makes
it seems like part of the expression. The comma can disappear at the
end of the line, but the “let” stands out more.</li>
<li>DN: Then we should make sure that the spec says this is for
readability or the other reasons so that it’s cleary.</li>
<li>JL: The note at the end of 4.13 is an example of code that’s easier
to read with multple “let”s.</li>
<li>DN: I wouldn’t find it any harder to read if the second and
following “let”s were replaced with commas.</li>
<li>RD: We don’t have similar justification for any of the other parts of the spec.</li>
<li>MK: There are lots of places where we do and lots of places where we
don’t.</li>
<li>EP: Wouldn’t it be just as good to put that in the changes appendix?</li>
<li>MSM: I think the list of changes is the right place to say that this
change is syntactic sugar. I sometimes react allergically when
changes are described as for usability when I find them less usable.</li>
</ul>

<p>
ACTION QT4CG-022-03: MK to add a note about why multiple for and let clauses were added to XPath
</p>

<p>
Proposal: Accept this PR
</p>

<p>
Accepted.
</p>

<p>
(MK will provide the note and then we’ll merge the PR.)
</p>
</div>
</div>

<div id="outline-container-h-8455483D-D0AF-499A-A74A-552B33A9F395" class="outline-3">
<h3 id="h-8455483D-D0AF-499A-A74A-552B33A9F395"><span class="section-number-3">2.3.</span> PR #320: Issue 98 - add options parameter to fn:deep-equal</h3>
<div class="outline-text-3" id="text-h-8455483D-D0AF-499A-A74A-552B33A9F395">
<p>
See <a href="https://qt4cg.org/dashboard/#pr-320">pull request #320</a>. When <a href="https://qt4cg.org/meeting/minutes/2023/02-07.html#h-8455483D-D0AF-499A-A74A-552B33A9F395">last we met</a>, Mike was working on test
cases and an implementation. More detail is expected.
</p>

<ul class="org-ul">
<li>MK: I have committed further changes. Let’s take a look.</li>
<li>MK: Where are we…</li>
<li>MK: The collation parameter should allow empty sequence.</li>
</ul>

<p>
ACTION QT4CG-022-04: MK to update the collation parameter on fn:deep-equal to accept an empty sequence.
</p>

<ul class="org-ul">
<li>MK: I’ve renamed and clarified a few options.
<ul class="org-ul">
<li>… Added ‘base-uri’ to compare base URIs.</li>
<li>… There was a comment about consistency of ‘idref’ vs. ‘idrefs’</li>
<li>… I renamed one of the parameters to ‘normalized-space’ for consistency.</li>
</ul></li>
</ul>

<p>
ACTION QT4CG-022-05: MK to make sure that the option list in fn:deep-equal is sorted lexicographically
</p>

<ul class="org-ul">
<li>MK: XSLT users are familiar with ‘preserve-space’ so I went with
that name.
<ul class="org-ul">
<li>… I expanded how equal-strings is described to include a code implementation.</li>
<li>… The rest is fairly mechanical…</li>
<li>… Added a note describing how the different whitespace handling
options relate to each other.</li>
<li>… I decided not to consider xml:space attributes.</li>
</ul></li>

<li>MSM: If you say xml:space=preserve and two documents have different
indentation, I will be preserved if they compare the same.</li>
<li>MK: Basically, whitespace is significant unless you say it isn’t and
there are a variety of ways to do that.
<ul class="org-ul">
<li>… There’s a note about what it means if you specify both
preserve-space and normalize-space. Basically 1 space equals 2
spaces, but no zero spaces.</li>
</ul></li>
<li>MK: The only real error condition is trying to compare functions.
You can get errors if you specify invalid options. I decided that
‘false-on-error’ doesn’t stop invalid options from being an error.</li>
<li>MK: And I added more examples. And there are many more in the test suite.</li>
<li>DN: I think this is very well done, but I would be more happy if the
default for the option ‘false-if-error’ was true. We need a
comparison function in many other places where we don’t want errors.
If we can’t change it here, I want another function with exactly the
same semantics but with false-if-error set to true.</li>
<li>MK: But that means that some sequences aren’t equal to themselves,
which bugs me.</li>
<li>DN: This inequality-to-self happens only if there are special,
abnormal values in the sequences such as NaN, plus or minus Infinity.</li>
<li>RD: You can’t really disregard things like NaN and infinities when
comparing values because in the IEEE specification, there’s more
than one NaN. That’s one of the reasons why comparing two NaN values
returns false.</li>
<li>DN: It is a lie that 'INF' is equal to 'INF'. We all know that the
infinity of all irrational numbers is greater than the infinity of all
rational numbers. When the Domain of the comparison function has these
abnormal values removed, then we truly have the property of reflexivity,
and thus the comparison is an equivalence relation.</li>
<li>MK: In deep-equal it returns true.</li>
<li>DN: We should fix that too.</li>
<li>MK: We’d need a new option if we wanted to change that.</li>
<li>RD: When comparing things like NaNs and infinities, what you
typically do is rely on the IEEE spec and things like the C
comparison functions that have specific behavior. We may not like
that behavior, but it is what it is.</li>
<li>DN: I’m proposing a new function deep-comparison that doesn’t have
backwards compatibility issues and can have any semantics we want.</li>
</ul>

<p>
We’ve run out of time. We’ll come back to this issue in two weeks;
next week is an XSLT-focused meeting.
</p>
</div>
</div>
</div>

<div id="outline-container-any-other-business" class="outline-2">
<h2 id="any-other-business"><span class="section-number-2">3.</span> Any other business</h2>
<div class="outline-text-2" id="text-any-other-business">
</div>
</div>
</div>
</body>
</html>
