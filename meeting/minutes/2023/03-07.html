<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>QT4 CG Meeting 025 Minutes 2023-03-07</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="/meeting/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="../../../css/style.css"/>
<link rel="shortcut icon" href="/img/QT4-64.png" />
<link rel="apple-touch-icon" sizes="64x64" href="/img/QT4-64.png" type="image/png" />
<link rel="apple-touch-icon" sizes="76x76" href="/img/QT4-76.png" type="image/png" />
<link rel="apple-touch-icon" sizes="120x120" href="/img/QT4-120.png" type="image/png" />
<link rel="apple-touch-icon" sizes="152x152" href="/img/QT4-152.png" type="image/png" />
</head>
<body>
<div id="content" class="content">
<h1 class="title">QT4 CG Meeting 025 Minutes 2023-03-07</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#minutes">Minutes</a></li>
<li><a href="#new-actions">Summary of new and continuing actions <code>[0/10]</code></a></li>
<li><a href="#administrivia">1. Administrivia</a>
<ul>
<li><a href="#roll-call">1.1. Roll call <code>[9/12]</code></a></li>
<li><a href="#agenda">1.2. Accept the agenda</a></li>
<li><a href="#approve-minutes">1.3. Approve minutes of the previous meeting</a></li>
<li><a href="#next-meeting">1.4. Next meeting</a></li>
<li><a href="#open-actions">1.5. Review of open action items <code>[1/7]</code></a></li>
</ul>
</li>
<li><a href="#technical-agenda">2. Technical Agenda</a>
<ul>
<li><a href="#h-074E7C57-5C3A-4FA8-AF9E-EAFE0F504864">2.1. PR #375: Context for default parameter values</a></li>
<li><a href="#h-7AC1783C-19E6-4163-8BE0-236FBABFE76E">2.2. PR #378: Update the localName and unparsed entity reference notes for parse-html</a></li>
<li><a href="#h-EDC3E35B-2AD7-4E6F-B92D-4369CF84D8DC">2.3. PR #371: Issue 370: forwards and backwards compatibility for 4.0</a></li>
<li><a href="#pr364">2.4. PR #364: Generalize switch expressions in XQuery</a></li>
<li><a href="#pr363">2.5. PR #363: Issue 345; missing rules for type matching</a></li>
<li><a href="#pr355">2.6. PR #355: Add to imp-defined-feature-appendix</a></li>
<li><a href="#h-751A3ADC-981F-4AB4-BFE4-523B8CD342C7">2.7. PR #344: Issue 22: allow "for"/"let" keyword to be repeated in XPath</a></li>
<li><a href="#h-9AF44047-B476-419D-A158-13D6BD879D4C">2.8. PR #347: Attempt to clarify fn:parse-uri and fn:build-uri</a></li>
</ul>
</li>
<li><a href="#any-other-business">3. Any other business</a></li>
</ul>
</div>
</div>

<div id="outline-container-minutes" class="outline-2">
<h2 id="minutes">Minutes</h2>
<div class="outline-text-2" id="text-minutes">
<p>
Approved <a href="./03-14.html">at meeting 026</a> on 14 March 2023.
</p>
</div>
</div>

<div id="outline-container-new-actions" class="outline-2">
<h2 id="new-actions">Summary of new and continuing actions <code>[0/10]</code></h2>
<div class="outline-text-2" id="text-new-actions">
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> QT4CG-002-10: BTW to coordinate some ideas about improving diversity in the group</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-016-08: RD to clarify how namespace comparisons are performed.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-023-01: NW to review the stylesheets for functions across XPath and XSLT</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-023-05: NW to put record types on an agenda.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-024-01: MK to add namespace-uri-for-prefix argument changes to the compatibility appendix</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-024-02: DN to develop an alternative proposal for deep-action.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-025-01: NW to close the issues we agreed to close in meeting 024</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-025-02: MK to make the context function properties simple values instead of functions</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-025-03: MK to revise and expand technical detail in PR #375</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-025-04: RD to remove the note in 15.5.15 of functions and operators.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-025-05: MK to correct the accidental deletion in 3.6.2 of XQuery</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-025-06: NW to fix the “blue boxes” in the serialization specification</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-025-07: MK to update the text about for/let changes to use use definitions and termrefs correctly.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-025-08: MK to add an error code for the case where <code>member</code> is used on something that isn’t an array</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-025-09: NW to add the parse-uri and build-uri tests to the test suite</li>
</ul>
</div>
</div>

<div id="outline-container-administrivia" class="outline-2">
<h2 id="administrivia"><span class="section-number-2">1.</span> Administrivia</h2>
<div class="outline-text-2" id="text-administrivia">
</div>

<div id="outline-container-roll-call" class="outline-3">
<h3 id="roll-call"><span class="section-number-3">1.1.</span> Roll call <code>[9/12]</code></h3>
<div class="outline-text-3" id="text-roll-call">
<p>
Regrets: BTW, DN
</p>

<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> Anthony (Tony) Bufort (AB)</li>
<li class="on"><code>[X]</code> Reece Dunn (RD)</li>
<li class="on"><code>[X]</code> Sasha Firsov (SF)</li>
<li class="on"><code>[X]</code> Christian Grün (CG)</li>
<li class="on"><code>[X]</code> Joel Kalvesmaki (JK) [:15-]</li>
<li class="on"><code>[X]</code> Michael Kay (MK)</li>
<li class="on"><code>[X]</code> John Lumley (JL)</li>
<li class="off"><code>[&#xa0;]</code> Dimitre Novatchev (DN)</li>
<li class="on"><code>[X]</code> Ed Porter (EP)</li>
<li class="on"><code>[X]</code> C. M. Sperberg-McQueen (MSM) [:08-]</li>
<li class="off"><code>[&#xa0;]</code> Bethan Tovey-Walsh (BTW)</li>
<li class="on"><code>[X]</code> Norm Tovey-Walsh (NW). <i>Scribe</i>. <i>Chair</i>.</li>
</ul>
</div>
</div>

<div id="outline-container-agenda" class="outline-3">
<h3 id="agenda"><span class="section-number-3">1.2.</span> Accept the agenda</h3>
<div class="outline-text-3" id="text-agenda">
<p>
Proposal: Accept <a href="../../agenda/2023/03-07.html">the agenda</a>.
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-approve-minutes" class="outline-3">
<h3 id="approve-minutes"><span class="section-number-3">1.3.</span> Approve minutes of the previous meeting</h3>
<div class="outline-text-3" id="text-approve-minutes">
<p>
Proposal: Accept <a href="../../minutes/2023/02-28.html">the minutes of the previous meeting</a>.
</p>

<ul class="org-ul">
<li>MK: First item was a discussion on closing various issues. I believe
we agreed to close some but didn’t make an action.</li>
</ul>

<p>
ACTION QT4CG-025-01: NW to close the issues we agreed to close in meeting 024
</p>

<ul class="org-ul">
<li>RD: Should be able to close the parse HTML issue as well.</li>
<li>MK: If you opened an issue and you think it can now be closed, I
think go ahead and close it.</li>
</ul>

<p>
Accepted as amended.
</p>
</div>
</div>

<div id="outline-container-next-meeting" class="outline-3">
<h3 id="next-meeting"><span class="section-number-3">1.4.</span> Next meeting</h3>
<div class="outline-text-3" id="text-next-meeting">
<p>
The next meeting <a href="../../agenda/2023/03-14.html">is scheduled for Tuesday, 14 March 2023</a>.
</p>

<p>
ATTENTION: This meeting is scheduled at 16:00 local time in Europe.
The United States will be on Daylight Saving Time starting on Sunday,
12 March 2023. Until Europe and the UK switch to summer time (on 26
March 2023), this meeting will be one hour <b>later</b> in the United
States starting <b>next week</b>.
</p>

<p>
No regrets heard.
</p>
</div>
</div>

<div id="outline-container-open-actions" class="outline-3">
<h3 id="open-actions"><span class="section-number-3">1.5.</span> Review of open action items <code>[1/7]</code></h3>
<div class="outline-text-3" id="text-open-actions">
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> QT4CG-002-10: BTW to coordinate some ideas about improving diversity in the group</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-016-08: RD to clarify how namespace comparisons are performed.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-023-01: NW to review the stylesheets for functions across XPath and XSLT</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-023-05: NW to put record types on an agenda.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-024-01: MK to add namespace-uri-for-prefix argument changes to the compatibility appendix</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-024-02: DN to develop an alternative proposal for deep-action.</li>
<li class="on"><code>[X]</code> QT4CG-024-03: NW to create issues for improving fn:deep-equal</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-technical-agenda" class="outline-2">
<h2 id="technical-agenda"><span class="section-number-2">2.</span> Technical Agenda</h2>
<div class="outline-text-2" id="text-technical-agenda">
<p>
Last week, the suggestion was made that we try to clear up a bit of
the back log in PRs by reviewing some of the smaller, simpler ones.
Please read these issues in preparation for the meeting so that we are
more likely to be able to move through them swiftly.
</p>
</div>

<div id="outline-container-h-074E7C57-5C3A-4FA8-AF9E-EAFE0F504864" class="outline-3">
<h3 id="h-074E7C57-5C3A-4FA8-AF9E-EAFE0F504864"><span class="section-number-3">2.1.</span> PR #375: Context for default parameter values</h3>
<div class="outline-text-3" id="text-h-074E7C57-5C3A-4FA8-AF9E-EAFE0F504864">
<p>
Contrary to the remark above, this <i>is not</i> a small issue. But it’s a
bug and deseves high priority. I propose a 30 minute time box on this
issue so that we do have time to resolve some low hanging fruit.
</p>

<p>
See <a href="https://qt4cg.org/dashboard/#pr-375">pull request #375</a>.
</p>

<ul class="org-ul">
<li>MK: I worked through all the changes in XQuery, but haven’t done the
corresponding changes on XSLT. If we agree with the design, it’s
fairly mechanical to translate to XSLT.
<ul class="org-ul">
<li>… In the course of doing this, I found that the two sections on
variable and function declarations had become unstructured and
unweildy. I reorganized them but that makes the diff hard to read.</li>
<li>… What should be the static and dynamic context for the expression
that defines a default value?</li>
<li>… Using the same static context as variable declarations fails to
satisfy the goal of allowing user-defined functions to have access
to the context item and default collation.</li>
<li>… First thought was to use something different for the dynamic
context, but that makes the inconsistent. The “static item context
type” for example becomes meaningless if the context item is taken
from the dynamic context.</li>
<li>… I thought about defining a custom context, we could do that, but
it’s a little bit daunting.</li>
<li>… I also thought about cutting back on our ambitions and allowing
only the static context. That’d lose the ability to use the
context.</li>
<li>… The proposal here introduces a new function that you can call in
the initializing expression that give you access to parts of the
callers context.</li>
<li>… I’m not enormously fond of the solution, but…</li>
</ul></li>
<li>RD: As a goal, I think it’s a good to make it possible to get to the
dynamic context.</li>
<li>CG: I think that it would be good to add an example of a function
item. I outlined it in a comment on issue #375.</li>
</ul>

<pre class="example">
let $filter := function(
  $item := caller-context()?context-item()
) {
  $item = 'Jupiter'
}
return //planet[$filter()]
</pre>

<ul class="org-ul">
<li>MK: Adding examples is part of the next phase if the design is accepted.</li>
<li>CG: Can we call the function <code>context()</code> and the item <code>item</code>?</li>
<li>MK: When we get to talking about the spelling, you’re in the home stretch.</li>
<li>JL: Couldn’t this be generalized to solve questions like “what’s my
current mode” in XSLT?</li>
<li>MK: Yes. I adopted a fairly extensible design on purpose.</li>
<li>JL: Would we also have to be fairly careful about security
implications? About being able to see things that the compiler has
got rid of.</li>
<li>MK: For access to the static context, that could be an issue. It’s
nice to be able to discard parts of that.</li>
<li>RD: In the current spec, where we’ve done <code>.</code> for the context, all
of those will need updating.</li>
<li>MK: Yes, if we do this, we’ll have to update the standard functions.</li>
</ul>

<p>
MK isn’t sure that it makes sense to attempt to go through in too much
detail. Reviews the non-diff version because of the changes caused by
reorganizing things into subsections.
</p>

<ul class="org-ul">
<li>MK: Most of the change is in 5.18.1…</li>
<li>JL: Why are the record types functions rather than just values?</li>
<li>MK: Probably to emphasize that you expect them to be evaluated
lazily; that’s probably particularly true of <code>last()</code>.
<ul class="org-ul">
<li>… We could leave out the brackets and make them properties rather than
methods.</li>
</ul></li>
<li>CG: One advantage of a simple map is that it makes it clear that the
values you get are specific to when the function was called.</li>
<li>RD: I’m in favor of them being ordinary variables.</li>
</ul>

<p>
ACTION QT4CG-025-02: MK to make the context function properties simple values instead of functions
</p>

<ul class="org-ul">
<li>MK: I think we’re looking for agreement in principle.</li>
<li>CG: The <code>$</code> character needs to be removed</li>
<li>MK: Yes, that’s a typo.</li>
<li>JL: In XSLT, we have a parallel where it’s a variable (in catches
and things).</li>
<li>MK: Yes, we define magic variables there. There are other places
where we define magic functions.</li>
<li>RD: XQuery does the same thing for variables in the catch expression.</li>
<li>MK: If it’s a magic variable, what namespace does it have to be in?</li>
<li>NW: We can leave it a function and not have to answer that question!</li>
<li>CG: A function also makes it clear that it changes when called in different places.</li>
<li>JL: Can you bind it to a variable?</li>
<li>MK: Yes, but the scope is going to be in your initializer so it can’t escape.</li>
</ul>

<p>
Proposal: accept this PR in principle, action to MK to expand it
</p>

<p>
Accepted.
</p>

<p>
ACTION QT4CG-025-03: MK to revise and expand technical detail in PR #375
</p>
</div>
</div>

<div id="outline-container-h-7AC1783C-19E6-4163-8BE0-236FBABFE76E" class="outline-3">
<h3 id="h-7AC1783C-19E6-4163-8BE0-236FBABFE76E"><span class="section-number-3">2.2.</span> PR #378: Update the localName and unparsed entity reference notes for parse-html</h3>
<div class="outline-text-3" id="text-h-7AC1783C-19E6-4163-8BE0-236FBABFE76E">
<p>
See <a href="https://qt4cg.org/dashboard/#pr-378">pull request #378</a>.
</p>

<ul class="org-ul">
<li>RD: This is a straightforward change; I’ve changed “must” to “will”
in various cases where we’re referring to ASCII lower case and
changed “unparsed” to “unknown”.</li>
</ul>

<p>
Some discussion of the “unparsed-entity-public-id” accessor. It’s not
relevant because HTML5 doesn’t have unparsed entities.
</p>

<p>
ACTION QT4CG-025-04: RD to remove the note in 15.5.15 of functions and operators.
</p>

<p>
Proposal: Accept as ammended?
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-h-EDC3E35B-2AD7-4E6F-B92D-4369CF84D8DC" class="outline-3">
<h3 id="h-EDC3E35B-2AD7-4E6F-B92D-4369CF84D8DC"><span class="section-number-3">2.3.</span> PR #371: Issue 370: forwards and backwards compatibility for 4.0</h3>
<div class="outline-text-3" id="text-h-EDC3E35B-2AD7-4E6F-B92D-4369CF84D8DC">
<p>
See <a href="https://qt4cg.org/dashboard/#pr-371">pull request #371</a>.
</p>

<ul class="org-ul">
<li>MK: This was editorially updating some things to say 4.0 instead of 3.0.</li>
</ul>

<p>
Proposal: Accept this PR?
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-pr364" class="outline-3">
<h3 id="pr364"><span class="section-number-3">2.4.</span> PR #364: Generalize switch expressions in XQuery</h3>
<div class="outline-text-3" id="text-pr364">
<p>
See <a href="https://qt4cg.org/dashboard/#pr-364">pull request #364</a>.
</p>

<ul class="org-ul">
<li>CG talks us through the changes to the switch expression.
<ul class="org-ul">
<li>… In the new version you can supply arbitrary lists of expressions
in the switch expressions. If any expression matches, then the
case is accepted. If it’s an empty expression it works as before.</li>
</ul></li>
</ul>

<p>
Proposal: Accept this PR?
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-pr363" class="outline-3">
<h3 id="pr363"><span class="section-number-3">2.5.</span> PR #363: Issue 345; missing rules for type matching</h3>
<div class="outline-text-3" id="text-pr363">
<p>
See <a href="https://qt4cg.org/dashboard/#pr-363">pull request #363</a>.
</p>

<ul class="org-ul">
<li>MK: This was a fairly obvious omission. I’ve added a few notes and
clarified what schema types are.
<ul class="org-ul">
<li>… Local union type and enumeration types are “schema types”</li>
<li>… etc.</li>
</ul></li>
</ul>

<p>
ACTION QT4CG-025-05: MK to correct the accidental deletion in 3.6.2 of XQuery
</p>

<ul class="org-ul">
<li>MK: The new rule in 3.6.2 is what was missing.
<ul class="org-ul">
<li>… The rest is expanding on the definitions and editorial improvements.</li>
</ul></li>
</ul>

<p>
Proposal: Accept this PR as amended?
</p>

<p>
Accepted.
</p>
</div>
</div>


<div id="outline-container-pr355" class="outline-3">
<h3 id="pr355"><span class="section-number-3">2.6.</span> PR #355: Add to imp-defined-feature-appendix</h3>
<div class="outline-text-3" id="text-pr355">
<p>
See <a href="https://qt4cg.org/dashboard/#pr-355">pull request #355</a>.
</p>

<p>
ACTION QT4CG-025-06: NW to fix the “blue boxes” in the serialization specification
</p>

<ul class="org-ul">
<li>MK: Adds two implement-defined features</li>
</ul>

<p>
Proposal: Accept this PR?
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-h-751A3ADC-981F-4AB4-BFE4-523B8CD342C7" class="outline-3">
<h3 id="h-751A3ADC-981F-4AB4-BFE4-523B8CD342C7"><span class="section-number-3">2.7.</span> PR #344: Issue 22: allow "for"/"let" keyword to be repeated in XPath</h3>
<div class="outline-text-3" id="text-h-751A3ADC-981F-4AB4-BFE4-523B8CD342C7">
<p>
See <a href="https://qt4cg.org/dashboard/#pr-344">pull request #344</a>.
</p>

<ul class="org-ul">
<li>MK: This one is a little bit more substantial.
<ul class="org-ul">
<li>… Tidies up the language about iterating in 4.12</li>
<li>… Slightly refactors the syntax but essentially let’s you have two
<code>for</code> clauses. It’s syntactic sugar to let you write expressions
in XPath that look more like XQuery.</li>
</ul></li>
<li>MSM: The refactoring of SimpleForBinding seems to make a grammatical
change is that intended?
<ul class="org-ul">
<li>… If I’m reading the grammar correctly, in the old grammar the keyword member is
optional before the first keyword binding in a for, but not in one following a comma.
Now it is allowed in front of any variable binding.</li>
</ul></li>
<li>MK: Yes, that’s correct. Now you can control <code>member</code> for each one
independently.</li>
<li>RD: I created an issue (<a href="https://github.com/qt4cg/qtspecs/issues/49">#49</a>) for this.
<ul class="org-ul">
<li>This goes into the discussion of the for-member functionality that
was added before we convened as a group.</li>
</ul></li>
<li>MK: Let’s check what the non-diff syntax looks like.
<ul class="org-ul">
<li>… The member keyword doesn’t propagate. If you say <code>member</code> your
iterating over an array; otherwise you’re iterating over a
sequence.</li>
</ul></li>

<li>MK: The PR does the same thing for <code>let</code>.</li>
<li>JL: We have an error case when its not an array and you use
<code>member</code>. I didn’t see an error code.</li>
</ul>

<p>
ACTION QT4CG-025-07: MK to update the text about for/let changes to use use definitions and termrefs correctly.
ACTION QT4CG-025-08: MK to add an error code for the case where <code>member</code> is used on something that isn’t an array
</p>

<p>
Proposal: Accept this PR?
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-h-9AF44047-B476-419D-A158-13D6BD879D4C" class="outline-3">
<h3 id="h-9AF44047-B476-419D-A158-13D6BD879D4C"><span class="section-number-3">2.8.</span> PR #347: Attempt to clarify fn:parse-uri and fn:build-uri</h3>
<div class="outline-text-3" id="text-h-9AF44047-B476-419D-A158-13D6BD879D4C">
<p>
See <a href="https://qt4cg.org/dashboard/#pr-347">pull request #347</a>.
</p>

<ul class="org-ul">
<li>NW walks through the changes.</li>
</ul>

<p>
ACTION QT4CG-025-09: NW to add the parse-uri and build-uri tests to the test suite
</p>

<p>
Proposal: Accept this PR?
</p>

<p>
Accepted.
</p>
</div>
</div>
</div>

<div id="outline-container-any-other-business" class="outline-2">
<h2 id="any-other-business"><span class="section-number-2">3.</span> Any other business</h2>
<div class="outline-text-2" id="text-any-other-business">
<p>
None heard.
</p>
</div>
</div>
</div>
</body>
</html>
