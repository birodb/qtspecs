<!DOCTYPE HTML><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1"><link rel="stylesheet" href="/css/status.css"><title>@qt4cg statuses</title></head><body><main><article><h1>@qt4cg statuses</h1><p>This page displays recent status
            updates
            about the QT4CG project.</p><p>The are also captured in <a href="status.rss">an RSS feed</a>.</p><p>By year: <a href="2023/">2023</a>, <a href="2022/">2022</a>, <a href="2021/">2021</a>, <a href="2020/">2020</a></p><div class="toots">
<div class="toot" id="closed-473"><h2>Issue #473 closed<span class="toot-id"> #closed-473</span></h2><div class="pubdate">09 May at 18:27:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/473">https://github.com/qt4cg/qtspecs/issues/473</a></div><p>NaN ne NaN</p></div>
<div class="toot" id="closed-321"><h2>Issue #321 closed<span class="toot-id"> #closed-321</span></h2><div class="pubdate">09 May at 18:26:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/321">https://github.com/qt4cg/qtspecs/issues/321</a></div><p>relax $input in fn:serialize</p></div>
<div class="toot" id="closed-325"><h2>Issue #325 closed<span class="toot-id"> #closed-325</span></h2><div class="pubdate">09 May at 18:25:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/325">https://github.com/qt4cg/qtspecs/issues/325</a></div><p>Operator precedence table needs updating</p></div>
<div class="toot" id="closed-482"><h2>Issue #482 closed<span class="toot-id"> #closed-482</span></h2><div class="pubdate">09 May at 18:24:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/482">https://github.com/qt4cg/qtspecs/pull/482</a></div><p>473: NaN Comparisons (bug fix)</p></div>
<div class="toot" id="closed-476"><h2>Issue #476 closed<span class="toot-id"> #closed-476</span></h2><div class="pubdate">09 May at 18:24:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/476">https://github.com/qt4cg/qtspecs/pull/476</a></div><p>29: array:values</p></div>
<div class="toot" id="closed-475"><h2>Issue #475 closed<span class="toot-id"> #closed-475</span></h2><div class="pubdate">09 May at 18:23:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/475">https://github.com/qt4cg/qtspecs/pull/475</a></div><p>471: fn: prefix removed from function calls in the examples</p></div>
<div class="toot" id="closed-472"><h2>Issue #472 closed<span class="toot-id"> #closed-472</span></h2><div class="pubdate">09 May at 18:23:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/472">https://github.com/qt4cg/qtspecs/pull/472</a></div><p>321: Add new note and examples demonstrating adaptive serialization method</p></div>
<div class="toot" id="closed-468"><h2>Issue #468 closed<span class="toot-id"> #closed-468</span></h2><div class="pubdate">09 May at 18:23:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/468">https://github.com/qt4cg/qtspecs/pull/468</a></div><p>325 Update operator precedence table</p></div>
<div class="toot" id="closed-462"><h2>Issue #462 closed<span class="toot-id"> #closed-462</span></h2><div class="pubdate">09 May at 18:22:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/462">https://github.com/qt4cg/qtspecs/pull/462</a></div><p>434: Added examples for parse-integer()</p></div>
<div class="toot" id="created-483"><h2>Pull request #483 created<span class="toot-id"> #created-483</span></h2><div class="pubdate">08 May at 09:05:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/483">https://github.com/qt4cg/qtspecs/pull/483</a></div><p>452: window: make 'start' and 'when' optional</p></div>
<div class="toot" id="created-482"><h2>Pull request #482 created<span class="toot-id"> #created-482</span></h2><div class="pubdate">07 May at 20:05:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/482">https://github.com/qt4cg/qtspecs/pull/482</a></div><details><summary>473: NaN Comparisons (bug fix)</summary><div class="markup"><p>Drops the incorrect statement suggesting that NaN xx NaN is always false, for all six operators xx. In fact NaN ne NaN is true, as statements elsewhere in the spec make clear. Specifically, the operator mapping appendix of the XPath/XQuery language spec makes clear that <code>X ne Y</code> maps to <code>not(op:numeric-equal(X, Y))</code>.</p>
</div></details></div>
<div class="toot" id="created-481"><h2>Issue #481 created<span class="toot-id"> #created-481</span></h2><div class="pubdate">07 May at 18:43:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/481">https://github.com/qt4cg/qtspecs/issues/481</a></div><details><summary>When we have array:build and map:build, then why do we also need array:of and map:of ?</summary><div class="markup"><p>Looking at the current specification of the pairs of functions: (<strong><em><a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-array-build">array:build</a></em></strong>, <strong><em><a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-array-of">array:of</a></em></strong>) and (<strong><em><a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-map-build">map:build</a></em></strong>, <strong><em><a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-map-of">map:of</a></em></strong>), it is impossible not to notice that the second function in each of these pairs is a weak duplicate of the first.</p>
<p>Also, the examples provided for <strong><em>array:build</em></strong> and <strong><em>array:of</em></strong>, seem to have a good deal of common content / duplication / overlap.</p>
<p>Another issue is that <strong><em>array:of</em></strong> requires as input a sequence of  <strong>value records</strong>, whose definition is challenging to understand (and whose meaning seems to be solely to represent a sequence of sequences), and what is also really challenging is how to construct this argument to <strong><em>array:of</em></strong>. If this is unnatural and challenging, one would probably prefer to use just <strong><em>array:build</em></strong>.</p>
<p>Is there an example where it is possible to construct an array (or a map) with <strong><em>array:of</em></strong> (or with <strong><em>map:of</em></strong>) but it is impossible (or significantly more difficult) to construct the same array/map with the function <strong><em>array:build</em></strong> (or with <strong><em>map:build</em></strong>)?</p>
<p>If there are no such significant and convincing examples, then why do we need the <strong><em>xxx:of</em></strong> functions?</p>
<p>Thus the question naturally arises:  "<strong><em>Why is the function <code>xxx:of</code> necessary at all?</em></strong>"</p>
</div></details></div>
<div class="toot" id="created-480"><h2>Issue #480 created<span class="toot-id"> #created-480</span></h2><div class="pubdate">07 May at 18:22:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/480">https://github.com/qt4cg/qtspecs/issues/480</a></div><details><summary>Allow type promotion of xs:string to xs:anyURI</summary><div class="markup"><p>If it hasn't already been considered and ruled out, I'd like to propose adding a type promotion rule to XPath 4 that would allow <code>xs:string</code> to be type-promoted to <code>xs:anyURI</code>, so that functions with parameters whose types are declared as <code>xs:anyURI</code> can directly take <code>xs:string</code> values, without having to first cast these to <code>xs:anyURI</code>.</p>
<p>This would empower function authors to select <code>xs:anyURI</code> as a type - signaling that they’re expecting a URI - without forcing users of the function into explicitly casting their string-typed URIs.</p>
<p>The motivation behind this proposal is that many eXist users are frustrated when using the eXist extension functions that properly declare parameters as <code>xs:anyURI</code>. If this proposal isn’t adopted, that’s ok; we’ll just eliminate the use of <code>xs:anyURI</code> in our functions, as proposed in https://github.com/eXist-db/exist/issues/4632. But this would a bit unfortunate for authors of functions who see the use of <code>xs:anyURI</code> as a proper expression of intent in their functions.</p>
<p>The change would be to https://www.w3.org/TR/xpath-31/#promotion - and I guess would be a 3rd item, called "String type promotion", saying:</p>
<blockquote>
<p>A value of type <code>xs:string</code> can be promoted to the type <code>xs:anyURI</code>. The result of this promotion is created by casting the original value to the type <code>xs:anyURI</code>.</p>
</blockquote>
</div></details></div>
<div class="toot" id="created-479"><h2>Issue #479 created<span class="toot-id"> #created-479</span></h2><div class="pubdate">07 May at 11:33:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/479">https://github.com/qt4cg/qtspecs/issues/479</a></div><details><summary>fn:deep-equal: Input order</summary><div class="markup"><p>#383 is about the specific order of children of element nodes.</p>
<p>I think we should also provide an option to ignore the top-level order of the input items:</p>
<pre><code class="language-xquery">(: returns true: both input arguments contain the same items, but in a different order :)
deep-equal(
  (1 to 10),
  reverse(1 to 10),
  map { 'unordered': true() }
)

(: returns false: the compared elements are different :)
deep-equal(
  &lt;a&gt;&lt;b/&gt;&lt;c/&gt;&lt;/a&gt;,
  &lt;a&gt;&lt;c/&gt;&lt;b/&gt;&lt;/a&gt;,
  map { 'unordered': true() }
)

(: returns false: the second sequence contains duplicates :)
deep-equal(
  (1, 2),
  (2, 1, 1),
  map { 'unordered': true() }
)
</code></pre>
</div></details></div>
<div class="toot" id="created-478"><h2>Pull request #478 created<span class="toot-id"> #created-478</span></h2><div class="pubdate">07 May at 10:53:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/478">https://github.com/qt4cg/qtspecs/pull/478</a></div><p>467: map:keys-where</p></div>
<div class="toot" id="created-477"><h2>Pull request #477 created<span class="toot-id"> #created-477</span></h2><div class="pubdate">07 May at 10:04:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/477">https://github.com/qt4cg/qtspecs/pull/477</a></div><p>63: array:slice (editorial)</p></div>
<div class="toot" id="created-476"><h2>Pull request #476 created<span class="toot-id"> #created-476</span></h2><div class="pubdate">07 May at 09:59:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/476">https://github.com/qt4cg/qtspecs/pull/476</a></div><p>29: array:values</p></div>
<div class="toot" id="closed-423"><h2>Issue #423 closed<span class="toot-id"> #closed-423</span></h2><div class="pubdate">05 May at 17:49:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/423">https://github.com/qt4cg/qtspecs/issues/423</a></div><p>[XSLT 4.0] 2.2 Notation is incomplete</p></div>
<div class="toot" id="created-475"><h2>Pull request #475 created<span class="toot-id"> #created-475</span></h2><div class="pubdate">05 May at 16:02:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/475">https://github.com/qt4cg/qtspecs/pull/475</a></div><details><summary>471: fn: prefix removed from function calls in the examples</summary><div class="markup"><p>#471: I’ve removed the <code>fn:</code> prefixes from the function calls in the examples.</p>
<p>I have left pretty much all <code>true</code>/<code>false</code> strings untouched, since I’m not sure what would be the most consistent approach to clean them up. It will be better anyway to create a separate PR for that.</p>
</div></details></div>
<div class="toot" id="closed-474"><h2>Issue #474 closed<span class="toot-id"> #closed-474</span></h2><div class="pubdate">05 May at 13:14:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/474">https://github.com/qt4cg/qtspecs/pull/474</a></div><p>Per comments on #465, improve presentation of multi-line expressions</p></div>
<div class="toot" id="closed-465"><h2>Issue #465 closed<span class="toot-id"> #closed-465</span></h2><div class="pubdate">05 May at 12:16:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/465">https://github.com/qt4cg/qtspecs/pull/465</a></div><p>80: fn:iterate-while: Examples revised</p></div>
<div class="toot" id="created-474"><h2>Pull request #474 created<span class="toot-id"> #created-474</span></h2><div class="pubdate">05 May at 11:52:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/474">https://github.com/qt4cg/qtspecs/pull/474</a></div><details><summary>Per comments on #465, improve presentation of multi-line expressions</summary><div class="markup"><p>This PR addresses points raised in the comments on #465.</p>
<p>If an <code>fos:expression</code> element is a code block, nest an <code>eg</code> inside it:</p>
<pre><code class="language-xml">               &lt;fos:expression&gt;&lt;eg&gt;&lt;![CDATA[let $input := 3936256
return fn:iterate-while(
  $input,
  function($result) { abs($result * $result - $input) &gt;= 0.0000000001 },
  function($guess) { ($guess + $input div $guess) div 2 }
)]]&gt;&lt;/eg&gt;&lt;/fos:expression&gt;
</code></pre>
<p>I found four examples where an <code>fos:expression</code> contained more than one newline and I added <code>eg</code> wrappers in those cases.</p>
<p>There are many more <code>fos:expression</code> elements that contain a single newline, but automatically formatting them as code blocks was often unsuccessful. Many of those cases seem to be just newlines entered for authoring convenience.</p>
<p>I also fixed the CSS for code blocks and attempte to remove trailing newlines from code blocks.</p>
</div></details></div>
<div class="toot" id="created-473"><h2>Issue #473 created<span class="toot-id"> #created-473</span></h2><div class="pubdate">04 May at 17:18:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/473">https://github.com/qt4cg/qtspecs/issues/473</a></div><details><summary>NaN ne NaN</summary><div class="markup"><p>It seems that ever since 2.0, the section in Functions and Operators "Comparison Operators on Numeric Values" (currently §4.3) has stated "If either, or both, operands are NaN, false is returned."</p>
<p>This is incorrect. If the operator is <code>ne</code>, then the correct result is true.</p>
<p>(And editorially, the first two commas in this sentence should be dropped).</p>
</div></details></div>
<div class="toot" id="created-472"><h2>Pull request #472 created<span class="toot-id"> #created-472</span></h2><div class="pubdate">04 May at 15:21:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/472">https://github.com/qt4cg/qtspecs/pull/472</a></div><details><summary>321: Add new note and examples demonstrating adaptive serialization method</summary><div class="markup"><p>Per <a href="https://github.com/qt4cg/qtspecs/issues/321">Issue 321</a>, I've added a new note and two additional simple examples noting the adaptive serialization method to draw attention to this feature in the existing specs.</p>
</div></details></div>
<div class="toot" id="created-471"><h2>Issue #471 created<span class="toot-id"> #created-471</span></h2><div class="pubdate">04 May at 13:03:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/471">https://github.com/qt4cg/qtspecs/issues/471</a></div><details><summary>Unify function calls in the examples and rules in the specification</summary><div class="markup"><p>Inspired by https://github.com/qt4cg/qtspecs/pull/454#issuecomment-1534633089 ff.</p>
<p>The syntax of the examples in the XQFO specification is inconsistent. Sometimes, functions in the standard function namespace have an <code>fn</code> prefix…</p>
<ul>
<li><code>fn:fold-right(1 to 5, "", fn:concat(?, ".", ?))</code></li>
<li><code>fn:substring("motor car", 6)</code></li>
</ul>
<p>…sometimes they don’t…</p>
<ul>
<li><code>data(123)</code></li>
<li><code>concat("http://www.example.com/", encode-for-uri("~bébé"))</code></li>
</ul>
<p>…sometimes it’s both:</p>
<ul>
<li><code>fn:fold-right(1 to 5, "$zero", concat("$f(", ?, ", ", ?, ")"))</code></li>
<li><code>fn:concat(01, 02, 03, 04, true())</code></li>
<li><code>fn:tokenize(fn:unparsed-text($href), '\r\n|\r|\n')[not(position()=last() and .='')]</code></li>
</ul>
<p>Should we drop or keep the prefix – or doesn’t it really matter? If there’s interest, I can create a PR (I’d tend to drop the prefixes).</p>
<p>In addition, there doesn’t seem to be a consistent rule for representing booleans. We have:</p>
<p>Syntax | Comment
--- | ---
…returns false | mostly used in the rules (seems appropriate to me)
…returns <code>false</code> | used in the rules; maybe we should use replace it with the first syntax?
…the result is <code>fn:false()</code> | used in the rules; maybe we should use replace it with the first syntax?
…returns <code>false()</code> | mostly used in the examples (seems appropriate to me)</p>
</div></details></div>
<div class="toot" id="created-470"><h2>Pull request #470 created<span class="toot-id"> #created-470</span></h2><div class="pubdate">04 May at 11:34:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/470">https://github.com/qt4cg/qtspecs/pull/470</a></div><details><summary>369 add fixed-prefixes attribute in XSLT</summary><div class="markup"><p>A solution to some of the problems identified in issue #369. This proposal affects XSLT only.</p>
</div></details></div>
<div class="toot" id="created-469"><h2>Issue #469 created<span class="toot-id"> #created-469</span></h2><div class="pubdate">04 May at 07:09:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/469">https://github.com/qt4cg/qtspecs/issues/469</a></div><details><summary>array:of, map:of: Signatures</summary><div class="markup"><p>Just trivia; I’ll be happy to write the PR:</p>
<p>a) The parameter name of <code>array:of</code> is <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-array-of"><code>$input</code></a>.
&nbsp;&nbsp;&nbsp;&nbsp;<code>$members</code> may be a better choice (or we should change <code>map:of($pairs)</code> to <code>map:of($input)</code>).</p>
<p>b) The type of <code>$pairs</code> is <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-map-of"><code>record(key as xs:anyAtomicType, value as item()*, *)*</code></a>.
&nbsp;&nbsp;&nbsp;&nbsp;Shouldn’t it be <code>record(key as xs:anyAtomicType, value as item()*)*</code> (without the trailing <code>, *</code>)?
&nbsp;&nbsp;&nbsp;&nbsp;If the current syntax is correct, an explanatory comment could be helpful.</p>
</div></details></div>
<div class="toot" id="created-468"><h2>Pull request #468 created<span class="toot-id"> #created-468</span></h2><div class="pubdate">03 May at 21:59:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/468">https://github.com/qt4cg/qtspecs/pull/468</a></div><details><summary>325 Update operator precedence table</summary><div class="markup"><p>Add "otherwise" and thin arrow to the table. Editorial.</p>
</div></details></div>
<div class="toot" id="created-467"><h2>Issue #467 created<span class="toot-id"> #created-467</span></h2><div class="pubdate">03 May at 11:09:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/467">https://github.com/qt4cg/qtspecs/issues/467</a></div><details><summary>map:keys-where: Return Keys That Match a Predicate</summary><div class="markup"><h3>Motivation</h3>
<p>We have <code>fn:index-where</code> and <code>array:index-where</code> to locate items/members in a sequence/an array that match a specific predicate, and we could introduce an equivalent function for maps. A recent use case can be found in https://github.com/qt4cg/qtspecs/issues/413#issuecomment-1531288167d.</p>
<h3>Proposal</h3>
<h4>Summary</h4>
<p>Returns keys of map entries for which the value matches a supplied predicate.</p>
<h4>Signature</h4>
<pre><code class="language-xquery">map:keys-where(
  $map        as map(*),
  $predicate  as function(item()*) as xs:boolean
) as xs:anyAtomicValue*
</code></pre>
<h4>Properties</h4>
<p>This function is ·deterministic·, ·context-independent·, and ·focus-independent·.</p>
<h4>Rules</h4>
<p>The function takes any ·map· as its <code>$map</code> argument and applies the supplied function to the value of each map entry. The function supplied as <code>$predicate</code> takes the value of the corresponding map entry as an argument, and the result is a sequence containing the keys of those entries for which the function returns true.</p>
<p>More formally, the function returns the result of the expression:</p>
<pre><code class="language-xquery">map:for-each(
  $map,
  function($key, $value) {
    if($predicate($value)) then $key else ()
  }
)
</code></pre>
<h4>Examples</h4>
<pre><code class="language-xquery">let $numbers := map { 0: 'zero', 1: 'one', 2: 'two', 3: 'three' }
return map:keys-where($numbers, function($string) { $string = 'two' })
</code></pre>
<h3>Comments</h3>
<ul>
<li><strong>Edit (2023-05-04):</strong> Renamed from <code>map:key-where</code> to <code>map:keys-where</code>.</li>
<li>Similar functions (<code>index-of</code>, <code>index-where</code>) use the singular form.</li>
<li>An alternative would be to add an optional <code>$predicate</code> function argument to <code>map:keys</code>.</li>
<li>If we decide to introduce a shorter syntax (see <a href="https://github.com/qt4cg/qtspecs/issues/129">#129</a> and <a href="https://github.com/qt4cg/qtspecs/issues/129">#436</a>), we could have:</li>
</ul>
<pre><code class="language-xquery">map:keys-where($numbers, { . = 'two ' })
</code></pre>
</div></details></div>
<div class="toot" id="created-466"><h2>Pull request #466 created<span class="toot-id"> #created-466</span></h2><div class="pubdate">02 May at 23:36:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/466">https://github.com/qt4cg/qtspecs/pull/466</a></div><details><summary>460: Fix math symbols</summary><div class="markup"><p>(1) drops the mathematical operator symbols appendix, which allowed an extensive range of non-ASCII characters as synonyms for language keywords, (2) retains × and ÷ as synonyms for multiplication and division, (3) allows full-width <code>&lt;</code> and <code>&gt;</code> in operator symbols in place of the usual ASCII characters, to avoid the need for XML escaping.</p>
</div></details></div></div><p>See 819
            more statuses in yearly archives.</p></article></main></body></html>