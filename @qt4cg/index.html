<!DOCTYPE HTML><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1"><link rel="stylesheet" href="/css/status.css"><title>@qt4cg statuses</title></head><body><main><article><h1>@qt4cg statuses</h1><p>This page displays recent status
            updates
            about the QT4CG project.</p><p>The are also captured in <a href="status.rss">an RSS feed</a>.</p><p>By year: <a href="2023/">2023</a>, <a href="2022/">2022</a>, <a href="2021/">2021</a>, <a href="2020/">2020</a></p><div class="toots">
<div class="toot" id="agenda-05-23"><h2>QT4 CG meeting 035 draft agenda<span class="toot-id"> #agenda-05-23</span></h2><div class="pubdate">20 May at 10:15:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2023/05-23">https://qt4cg.org/meeting/agenda/2023/05-23</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="closed-471"><h2>Issue #471 closed<span class="toot-id"> #closed-471</span></h2><div class="pubdate">20 May at 10:04:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/471">https://github.com/qt4cg/qtspecs/issues/471</a></div><p>Unify formatting (function calls, code blocks, quotes) in the specification</p></div>
<div class="toot" id="closed-511"><h2>Issue #511 closed<span class="toot-id"> #closed-511</span></h2><div class="pubdate">20 May at 10:04:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/511">https://github.com/qt4cg/qtspecs/pull/511</a></div><p>471: &lt;code&gt; elements, simple/typographic quotes</p></div>
<div class="toot" id="created-515"><h2>Pull request #515 created<span class="toot-id"> #created-515</span></h2><div class="pubdate">20 May at 09:57:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/515">https://github.com/qt4cg/qtspecs/pull/515</a></div><p>504: Merge map:keys and map:keys-where</p></div>
<div class="toot" id="created-514"><h2>Issue #514 created<span class="toot-id"> #created-514</span></h2><div class="pubdate">20 May at 08:44:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/514">https://github.com/qt4cg/qtspecs/issues/514</a></div><details><summary>Lambda expression: Annotations, type declarations</summary><div class="markup"><p>In the current grammar rules, there are subtle differences in the <code>InlineFunctionExpr</code> and <code>LambdaExpr</code> rules that we should dissolve.</p>
<p>First, annotations are not supported in lambda expressions, which I believe is an unnecessary restriction:</p>
<pre><code class="language-xquery">(: currently legal :)
let $delete-texts := %updating function($nodes) { delete nodes $nodes//text() }
return $delete-texts(//city)

(: currently illegal :)
let $delete-texts := %updating ($nodes) -&gt; { delete nodes $nodes//text() }
return $delete-texts(//city)
</code></pre>
<p>Next, parameters should be allowed to have type declarations:</p>
<pre><code class="language-xquery">(: currently legal :)
let $find-john := function($node as node()) as xs:boolean { contains($node, 'john') }
return $find-john($node)

(: currently illegal :)
let $find-john := ($node as node()) as xs:boolean -&gt; { contains($node, 'john') }
return $find-john($node)
</code></pre>
<p>The type declarations cannot be allowed if parentheses are omitted (unless we make them mandatory):</p>
<pre><code class="language-xquery">(: without parens :)
$i -&gt; { ... }

(: parens :)
($i as xs:int) as xs:int -&gt; { ... }
</code></pre>
<p>These are the current grammar rules:</p>
<pre><code>FunctionItemExpr    ::=  NamedFunctionRef | InlineFunctionExpr | LambdaExpr
InlineFunctionExpr  ::=  Annotation* "function" FunctionSignature FunctionBody
FunctionSignature   ::=  "(" ParamList? ")" TypeDeclaration?
ParamList           ::=  Param ("," Param)*
Param               ::=  "$" EQName TypeDeclaration?
FunctionBody        ::=  EnclosedExpr
LambdaExpr          ::=  LambdaParams "-&gt;" EnclosedExpr
LambdaParams        ::=  LambdaParam | "(" | (LambdaParam ("," LambdaParam)*)? | ")"
LambdaParam         ::=  "$" VarName
</code></pre>
<p>As the <code>InlineFunctionExpr</code> and <code>LambdaExpr</code> both generate anonymous functions, we shouldn’t make a difference, and this is what I would recommend:</p>
<pre><code>FunctionItemExpr    ::=  NamedFunctionRef | InlineFunctionExpr
InlineFunctionExpr  ::=  Annotation* (InlineFunction | LambdaFunction) FunctionBody
InlineFunction      ::=  "function" FunctionSignature
LambdaFunction      ::=  (Param | FunctionSignature)) "-&gt;"
FunctionSignature   ::=  "(" ParamList? ")" TypeDeclaration?
ParamList           ::=  TypedParam ("," TypedParam)*
TypedParam          ::=  Param TypeDeclaration?
Param               ::=  "$" VarName
</code></pre>
<p>Disclaimer: I could have raised this earlier, but I didn’t want to prolong the ongoing discussion on the open pull requests.</p>
</div></details></div>
<div class="toot" id="created-513"><h2>Issue #513 created<span class="toot-id"> #created-513</span></h2><div class="pubdate">20 May at 08:00:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/513">https://github.com/qt4cg/qtspecs/issues/513</a></div><details><summary>Arrow operator: Inline functions without parens</summary><div class="markup"><p>See also https://github.com/qt4cg/qtspecs/issues/435#issuecomment-1508228624: If an inline function expression is used as the right-hand operand of the arrow operators, parentheses must be used:</p>
<pre><code class="language-xquery">(: now :)
$seq =&gt; (function($x) { ... })()
(: desirable :)
$seq =&gt; function($x) { ... }()
</code></pre>
<p>This could be changed by adding the <code>InlineFunctionExpr</code> to the <code>ArrowDynamicFunction</code> rule:</p>
<blockquote>
<p>[115]  SequenceArrowTarget  ::=  "=&gt;" ((ArrowStaticFunction ArgumentList) | (ArrowDynamicFunction PositionalArgumentList))
[151]  ArrowStaticFunction  ::=  EQName
[152]  ArrowDynamicFunction  ::=  VarRef | ParenthesizedExpr | <code>InlineFunctionExpr</code>
[142]  ArgumentList  ::=  "(" ((PositionalArguments ("," KeywordArguments)?) | KeywordArguments)? ")"
[143]  PositionalArgumentList  ::=  "(" PositionalArguments? ")"</p>
</blockquote>
<p>It will be best to tackle this after we’ve resolved #503, and we’ll have to check if the simplification doesn’t cause ambiguities.</p>
</div></details></div>
<div class="toot" id="closed-53"><h2>Issue #53 closed<span class="toot-id"> #closed-53</span></h2><div class="pubdate">19 May at 20:01:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/53">https://github.com/qt4cg/qtspecs/issues/53</a></div><p>Allow function keyword inline functions without parameters</p></div>
<div class="toot" id="closed-436"><h2>Issue #436 closed<span class="toot-id"> #closed-436</span></h2><div class="pubdate">19 May at 20:00:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/436">https://github.com/qt4cg/qtspecs/issues/436</a></div><p>Allow inline function expressions in arrow operator call chains</p></div>
<div class="toot" id="closed-435"><h2>Issue #435 closed<span class="toot-id"> #closed-435</span></h2><div class="pubdate">19 May at 20:00:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/435">https://github.com/qt4cg/qtspecs/issues/435</a></div><p>Remove the inlined function expression variant of the thin arrow operator</p></div>
<div class="toot" id="created-512"><h2>Pull request #512 created<span class="toot-id"> #created-512</span></h2><div class="pubdate">19 May at 14:47:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/512">https://github.com/qt4cg/qtspecs/pull/512</a></div><details><summary>256: Context for default function parameter expressions</summary><div class="markup"><p>This is a renewed attempt to tackle issue 256, which concerns how to define the static and dynamic context for default value expressions for optional function parameters in XQuery and XSLT. The resolution is to define the static and dynamic context for these expressions in detail.</p>
<p>To make this work, some refinement of the static and dynamic context definitions is needed:</p>
<ul>
<li>default collation is moved from the static context to the dynamic context, with a note that it is always known statically except in the case when defining the default for a function parameter.</li>
<li>static base URI (in the static context) and executable base URI (in the dynamic context) are now formally separated; previously we fudged this by saying they could be different, but without recognizing separate context components</li>
<li>the base URI for resolving relative collation URIs is now implementation defined. This allows implementors to use either the compile-time or run-time base URI, or some other URI defined using a processor API.</li>
</ul>
</div></details></div>
<div class="toot" id="created-511"><h2>Pull request #511 created<span class="toot-id"> #created-511</span></h2><div class="pubdate">19 May at 13:10:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/511">https://github.com/qt4cg/qtspecs/pull/511</a></div><details><summary>471: &lt;code&gt; elements, simple/typographic quotes</summary><div class="markup"><p>That was a work-intensive one, as expected, but I’m optimistic that the PR improves the overall situation.
I’ll be happy to see subsequent PRs if I missed something (e.g., I didn’t touch <code>ebnf.xml</code>).</p>
<p>Closes #471</p>
</div></details></div>
<div class="toot" id="closed-509"><h2>Issue #509 closed<span class="toot-id"> #closed-509</span></h2><div class="pubdate">19 May at 09:08:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/509">https://github.com/qt4cg/qtspecs/pull/509</a></div><p>471 (2): Remove more fn: prefixes</p></div>
<div class="toot" id="closed-510"><h2>Issue #510 closed<span class="toot-id"> #closed-510</span></h2><div class="pubdate">19 May at 09:08:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/510">https://github.com/qt4cg/qtspecs/pull/510</a></div><p>471 (3): Render false/true/NaN/INF/-INF/+INF as code</p></div>
<div class="toot" id="closed-375"><h2>Issue #375 closed<span class="toot-id"> #closed-375</span></h2><div class="pubdate">19 May at 08:48:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/375">https://github.com/qt4cg/qtspecs/pull/375</a></div><p>256: Context for default parameter values</p></div>
<div class="toot" id="closed-507"><h2>Issue #507 closed<span class="toot-id"> #closed-507</span></h2><div class="pubdate">19 May at 08:06:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/507">https://github.com/qt4cg/qtspecs/pull/507</a></div><p>125: Rename array:partition as fn:partition</p></div>
<div class="toot" id="closed-505"><h2>Issue #505 closed<span class="toot-id"> #closed-505</span></h2><div class="pubdate">18 May at 17:25:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/505">https://github.com/qt4cg/qtspecs/pull/505</a></div><p>418: Correct and expand an XSLT example</p></div>
<div class="toot" id="closed-447"><h2>Issue #447 closed<span class="toot-id"> #closed-447</span></h2><div class="pubdate">18 May at 17:24:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/447">https://github.com/qt4cg/qtspecs/pull/447</a></div><p>435, 53, 436: lambda expressions, thin arrows</p></div>
<div class="toot" id="closed-410"><h2>Issue #410 closed<span class="toot-id"> #closed-410</span></h2><div class="pubdate">18 May at 16:57:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/410">https://github.com/qt4cg/qtspecs/issues/410</a></div><p>Converting doubles to decimals, fractional digits</p></div>
<div class="toot" id="closed-455"><h2>Issue #455 closed<span class="toot-id"> #closed-455</span></h2><div class="pubdate">18 May at 16:57:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/455">https://github.com/qt4cg/qtspecs/pull/455</a></div><p>410: Converting doubles to decimals, fractional digits</p></div>
<div class="toot" id="closed-483"><h2>Issue #483 closed<span class="toot-id"> #closed-483</span></h2><div class="pubdate">18 May at 16:53:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/483">https://github.com/qt4cg/qtspecs/pull/483</a></div><p>452: window: make 'start' and 'when' optional</p></div>
<div class="toot" id="created-510"><h2>Pull request #510 created<span class="toot-id"> #created-510</span></h2><div class="pubdate">18 May at 16:14:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/510">https://github.com/qt4cg/qtspecs/pull/510</a></div><details><summary>471 (3): Render false/true/NaN/INF/-INF/+INF as code</summary><div class="markup"><p><code>NaN</code>, <code>INF</code>, <code>-INF</code> and <code>+INF</code> was easy, boolean values were trickier:</p>
<ul>
<li>I used <code>&lt;code&gt;</code> for “The result/value/option/property is true/false”, “is set to true/false” and similar.</li>
<li>I didn’t tag “This is true/false”, “The condition is true/false”  and similar.</li>
</ul>
<p>I hope there won’t be too many conflicts if this is directly merged after #509.</p>
</div></details></div>
<div class="toot" id="created-509"><h2>Pull request #509 created<span class="toot-id"> #created-509</span></h2><div class="pubdate">18 May at 12:38:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/509">https://github.com/qt4cg/qtspecs/pull/509</a></div><details><summary>471 (2): Remove more fn: prefixes</summary><div class="markup"><p>I’ve removed additional <code>fn:</code> prefixes from examples and <code>eg</code> code blocks. I have kept prefixes in the rules and formal code snippets untouched.</p>
<p>In the initial comment of #471, I have listed the remaining cleanups for which I want to prepare PRs.
I’ll wait until this and possibly some other PRs have been merged.</p>
</div></details></div>
<div class="toot" id="created-508"><h2>Issue #508 created<span class="toot-id"> #created-508</span></h2><div class="pubdate">17 May at 12:53:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/508">https://github.com/qt4cg/qtspecs/issues/508</a></div><details><summary>New Map &amp; Array Functions: Inconsistencies</summary><div class="markup"><h3>XQFO 3.1</h3>
<p>…provides the following functions/constructs for creating and accessing maps &amp; arrays:</p>
<p>Maps | Singleton Maps
:--- | :---
Decompose | –
Compose | <code>map:merge($maps)</code>
Create single | <code>map:entry($key, $value)</code><br><code>map { $key: $value }</code>
Extract keys | <code>map:keys($map)</code>
Extract values (flat) | <code>$map?*</code>
<strong>Arrays</strong> | <strong>Singleton Arrays</strong>
Decompose | –
Compose | <code>array:join($arrays)</code>
Create single | <code>[ $value ]</code>
Extract values (flat) | –</p>
<h3>XQFO 4.0 Draft</h3>
<p>…provides new functions for singletons and map representations:</p>
<p>Maps | Singleton Maps | Pairs (Key-Value Pair Maps)
:--- | :--- | :---
Decompose | <strong><code>map:entries($map)</code></strong> | <strong><code>map:pairs($map)</code></strong>
Compose | <code>map:merge($maps)</code> | <strong><code>map:of($pairs)</code></strong>
Create single | <code>map:entry($key, $value)</code><br><code>map { $key: $value }</code> | –<br><strong><code>map { 'key': $key, 'value': $value }</code></strong>
Extract keys | <code>map:keys($map)</code> | <strong><code>$pairs?key</code></strong>
Extract values (flat) | <strong><code>map:values($map)</code></strong><br><code>$map?*</code> | <strong><code>$pairs?value</code></strong>
<strong>Arrays</strong> | <strong>Singleton Arrays</strong> | <strong>Members (Value Maps)</strong>
Decompose | – | <strong><code>array:members($array)</code></strong>
Compose | <code>array:join($arrays)</code> | <strong><code>array:of($members)</code></strong>
Create single | <code>[ $value ]</code> | <strong><code>array { 'value': $value }</code></strong>
Extract values (flat) | <strong><code>array:values($array)</code></strong> | <strong><code>$members?value</code></strong></p>
<p>The following terminology can be derived from the function names:</p>
<ul>
<li>A key-value pair map with a single map pair is called a <strong>Pair</strong>.</li>
<li>A value map with a single array member is called a <strong>Member</strong>.</li>
<li>A singleton map is called an <strong>Entry</strong> (due to <code>map:entry</code>)</li>
<li>We have no name for a singleton array.</li>
</ul>
<h3>Complete the Picture</h3>
<p>I believe we should:</p>
<ol>
<li>rename <code>map:of</code> to <code>map:of-pairs</code> or <code>map:merge-pairs</code> (as a hint that singletons are not the expected input)</li>
<li>rename <code>array:of</code> to <code>array:of-members</code> or <code>array:join-members</code> (as a hint…)</li>
<li>add <code>map:pair</code> for creating a single pair</li>
<li>add <code>array:split</code> (<code>array:tokenize</code>, …?) for decomposing arrays to singleton arrays</li>
</ol>
<p>I’m not sure if we should add array functions for creating singletons or value maps; we also have <code>array:build</code>.</p>
</div></details></div>
<div class="toot" id="created-507"><h2>Pull request #507 created<span class="toot-id"> #created-507</span></h2><div class="pubdate">17 May at 11:38:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/507">https://github.com/qt4cg/qtspecs/pull/507</a></div><details><summary>125: Rename array:partition as fn:partition</summary><div class="markup"><p>Reworked this PR to deal with merge conflicts. Technical change was already accepted. Made a correction to the "equivalent expression" published in the spec, which has now been tested (and was found wanting...)</p>
</div></details></div>
<div class="toot" id="closed-454"><h2>Issue #454 closed<span class="toot-id"> #closed-454</span></h2><div class="pubdate">17 May at 09:23:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/454">https://github.com/qt4cg/qtspecs/pull/454</a></div><p>125: array:partition</p></div>
<div class="toot" id="created-506"><h2>Issue #506 created<span class="toot-id"> #created-506</span></h2><div class="pubdate">17 May at 09:08:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/506">https://github.com/qt4cg/qtspecs/issues/506</a></div><details><summary>fn:error: parameter names</summary><div class="markup"><p>We should rename the <code>$error-object</code> parameter to <code>$value</code>, as it will be bound to <code>$err:value</code> later on:</p>
<pre><code class="language-xquery">try {
  error(value := 123)
} catch * {
  $err:value
}
</code></pre>
<p>Next, “object” is rarely used in the specs.</p>
</div></details></div>
<div class="toot" id="closed-467"><h2>Issue #467 closed<span class="toot-id"> #closed-467</span></h2><div class="pubdate">17 May at 08:20:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/467">https://github.com/qt4cg/qtspecs/issues/467</a></div><p>map:keys-where: Return Keys That Match a Predicate</p></div>
<div class="toot" id="created-505"><h2>Pull request #505 created<span class="toot-id"> #created-505</span></h2><div class="pubdate">17 May at 08:14:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/505">https://github.com/qt4cg/qtspecs/pull/505</a></div><details><summary>418: Correct and expand an XSLT example</summary><div class="markup"><p>Makes a further correction to an example identified in issue #418, and adds to the example giving an alternative solution</p>
</div></details></div>
<div class="toot" id="created-504"><h2>Issue #504 created<span class="toot-id"> #created-504</span></h2><div class="pubdate">17 May at 07:46:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/504">https://github.com/qt4cg/qtspecs/issues/504</a></div><details><summary>Merge map:keys and map:keys-where</summary><div class="markup"><p>I propose that we merge <code>map:keys</code> and <code>map:keys-where</code> into a single function, with <code>map:keys#1</code> behaving like it does now, and <code>map:keys#2</code> taking over from <code>map:keys-where#2</code>. Effectively the default for the second argument becomes <code>true#0</code>.</p>
</div></details></div>
<div class="toot" id="closed-30"><h2>Issue #30 closed<span class="toot-id"> #closed-30</span></h2><div class="pubdate">17 May at 06:16:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/30">https://github.com/qt4cg/qtspecs/issues/30</a></div><p>Improve the discoverability and parseability of the mathematical operator symbols</p></div></div><p>See 899
            more statuses in yearly archives.</p></article></main></body></html>